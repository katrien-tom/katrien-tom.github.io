<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="React18 基础知识"><title>React18 基础</title>
<link rel=canonical href=https://blog.binggao.xyz/p/react-basic/><link rel=stylesheet href=/scss/style.min.4b3e211b32199885ac817f6e5448a41d9a748ccca53066f64e3bfdf55816bb6b.css><meta property='og:title' content="React18 基础"><meta property='og:description' content="React18 基础知识"><meta property='og:url' content='https://blog.binggao.xyz/p/react-basic/'><meta property='og:site_name' content='半夜酒的博客'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='react'><meta property='article:tag' content='react18'><meta property='article:tag' content='reat18基础'><meta property='article:published_time' content='2024-05-06T17:00:00+08:00'><meta property='article:modified_time' content='2024-05-06T17:00:00+08:00'><meta property='og:image' content='https://blog.binggao.xyz/p/react-basic/assets/1.png'><meta name=twitter:title content="React18 基础"><meta name=twitter:description content="React18 基础知识"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://blog.binggao.xyz/p/react-basic/assets/1.png'></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><div id=article-toolbar style=position:sticky;top:5px;z-index:1000><a href=/ class=back-home><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="15 6 9 12 15 18"/></svg>
<span>返回</span></a></div><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目录</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#1-清理文件>1. 清理文件</a></li></ol><ol><li><a href=#1-识别js表达式>1. 识别js表达式</a></li><li><a href=#2-jsx中实现列表渲染>2. JSX中实现列表渲染</a></li><li><a href=#3-条件渲染>3. 条件渲染</a></li><li><a href=#4-复杂条件渲染>4. 复杂条件渲染</a></li><li><a href=#5-react中的事件绑定>5. React中的事件绑定</a></li><li><a href=#6-react中的组件>6. React中的组件</a><ol><li><a href=#61-react组件>6.1 React组件</a></li></ol></li><li><a href=#7-usestate>7. useState</a><ol><li><a href=#71-usestate基础使用>7.1 useState基础使用</a></li><li><a href=#72-修改状态的规则>7.2 修改状态的规则</a></li></ol></li><li><a href=#8-组件的样式处理>8. 组件的样式处理</a></li><li><a href=#9-受控表单绑定>9. 受控表单绑定</a></li><li><a href=#10-react中获取dom>10. React中获取DOM</a></li><li><a href=#11-组件通信>11. 组件通信</a><ol><li><a href=#111-父传子>11.1 父传子</a><ol><li><a href=#1111-基础实现>11.1.1 基础实现</a></li><li><a href=#1112-父传子-props说明>11.1.2 父传子-props说明</a></li><li><a href=#1113-父传子-children说明>11.1.3 父传子-children说明</a></li></ol></li><li><a href=#112-子传父>11.2 子传父</a></li><li><a href=#113-使用状态提升实现兄弟组件通信>11.3 使用状态提升实现兄弟组件通信</a></li><li><a href=#114-使用context机制跨层级组件通信>11.4 使用Context机制跨层级组件通信</a></li></ol></li><li><a href=#12-useeffect的使用>12. useEffect的使用</a><ol><li><a href=#121-useeffect-的基础使用>12.1 useEffect 的基础使用</a></li><li><a href=#122-useeffect-依赖项参数说明>12.2 useEffect 依赖项参数说明</a><ol><li><a href=#1221-没有依赖项>12.2.1 没有依赖项</a></li><li><a href=#1222-空数组依赖项>12.2.2 空数组依赖项</a></li><li><a href=#1223-特定依赖项>12.2.3 特定依赖项</a></li></ol></li><li><a href=#123-useeffect--清除副作用>12.3 useEffect — 清除副作用</a></li></ol></li><li><a href=#13-自定义hook函数>13. 自定义Hook函数</a></li><li><a href=#14-react-hooks使用规则>14. React Hooks使用规则</a></li></ol><ol><li><a href=#1-redux介绍>1. Redux介绍</a></li><li><a href=#2-redux快速体验>2. Redux快速体验</a><ol><li><a href=#21-实现计数器>2.1 实现计数器</a></li></ol></li><li><a href=#3-redux数据流架构>3. Redux数据流架构</a></li><li><a href=#4-redux与react---环境准备>4. Redux与React - 环境准备</a><ol><li><a href=#41-配套工具>4.1 配套工具</a></li><li><a href=#42-配置基础环境>4.2 配置基础环境</a></li><li><a href=#43-store目录结构设计>4.3 store目录结构设计</a></li></ol></li><li><a href=#5-redux与react---实现counter>5. Redux与React - 实现counter</a><ol><li><a href=#51-整体路径熟悉>5.1 整体路径熟悉</a></li><li><a href=#52-使用react-toolkit-创建-counterstore>5.2 使用React Toolkit 创建 counterStore</a></li><li><a href=#53-为react注入store>5.3 为React注入store</a></li><li><a href=#54-react组件使用store中的数据>5.4 React组件使用store中的数据</a></li><li><a href=#55-react组件修改store中的数据>5.5 React组件修改store中的数据</a></li></ol></li><li><a href=#6-redux与react---提交action传参>6. Redux与React - 提交action传参</a></li><li><a href=#7-redux与react---异步action处理>7. Redux与React - 异步action处理</a></li><li><a href=#8-redux调试---devtools>8. Redux调试 - devtools</a></li></ol><ol><li><a href=#41-reactrouter快速体验>4.1 ReactRouter快速体验</a><ol><li><a href=#411-什么是前端路由>4.1.1 什么是前端路由</a></li><li><a href=#412-创建路由开发环境>4.1.2 创建路由开发环境</a></li><li><a href=#413-快速开始>4.1.3 快速开始</a></li><li><a href=#414-抽象路由模块>4.1.4 抽象路由模块</a></li></ol></li><li><a href=#42-路由导航>4.2 路由导航</a><ol><li><a href=#421-什么是路由导航>4.2.1 什么是路由导航</a></li><li><a href=#422-声明式导航>4.2.2 声明式导航</a></li><li><a href=#423-编程式导航>4.2.3 编程式导航</a></li></ol></li><li><a href=#42-导航传参>4.2. 导航传参</a></li><li><a href=#43-嵌套路由配置>4.3 嵌套路由配置</a><ol><li><a href=#431-什么是嵌套路由>4.3.1 什么是嵌套路由</a></li><li><a href=#432-嵌套路由配置>4.3.2 嵌套路由配置</a></li><li><a href=#433-默认二级路由>4.3.3 默认二级路由</a></li><li><a href=#434-404路由配置>4.3.4 404路由配置</a></li><li><a href=#435-俩种路由模式>4.3.5 俩种路由模式</a></li></ol></li></ol><ol><li><a href=#51-usereducer>5.1 useReducer</a><ol><li><a href=#511-基础用法>5.1.1 基础用法</a></li><li><a href=#512-修改state值-分派action传参>5.1.2 修改state值-分派action传参</a></li><li><a href=#513-更新流程>5.1.3 更新流程</a></li></ol></li><li><a href=#52-usememo>5.2 useMemo</a><ol><li><a href=#521-示例>5.2.1 示例</a></li></ol></li><li><a href=#53-reactmemo>5.3 React.memo</a><ol><li><a href=#531-组件默认的渲染机制>5.3.1 组件默认的渲染机制</a></li><li><a href=#532-使用reactmemo优化>5.3.2 使用React.memo优化</a></li><li><a href=#533-props的比较机制>5.3.3 props的比较机制</a></li><li><a href=#534-自定义比较函数>5.3.4 自定义比较函数</a></li></ol></li><li><a href=#54-usecallback>5.4 useCallback</a></li><li><a href=#55-forwardref>5.5 forwardRef</a></li><li><a href=#56-useimperativehandle>5.6 useImperativeHandle</a></li></ol><ol><li><a href=#61-快速上手>6.1 快速上手</a></li><li><a href=#62-异步支持>6.2 异步支持</a></li><li><a href=#63-切片模式>6.3 切片模式</a></li></ol><ol><li><ol><li><a href=#1-lodash-排序工具>1. lodash 排序工具</a></li><li><a href=#2-classnames-优化类名控制>2. classnames 优化类名控制</a></li><li><a href=#3-dayjs>3. dayjs</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/react-basic/><img src=/p/react-basic/assets/1_hu98f6fd50a4f2e293a2be77495df51183_325303_800x0_resize_box_3.png srcset="/p/react-basic/assets/1_hu98f6fd50a4f2e293a2be77495df51183_325303_800x0_resize_box_3.png 800w, /p/react-basic/assets/1_hu98f6fd50a4f2e293a2be77495df51183_325303_1600x0_resize_box_3.png 1600w" width=800 height=451 loading=lazy alt="Featured image of post React18 基础"></a></div><div class=article-details><header class=article-category><a href=/categories/react/>React</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/react-basic/>React18 基础</a></h2><h3 class=article-subtitle>React18 基础知识</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>May 06, 2024</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>阅读时长: 23 分钟</time></div></footer></div></header><section class=article-content><h1 id=react-18-基础><a href=#react-18-%e5%9f%ba%e7%a1%80>#</a>
React 18 基础</h1><h1 id=一react项目结构><a href=#%e4%b8%80react%e9%a1%b9%e7%9b%ae%e7%bb%93%e6%9e%84>#</a>
一、React项目结构</h1><h2 id=1-清理文件><a href=#1-%e6%b8%85%e7%90%86%e6%96%87%e4%bb%b6>#</a>
1. 清理文件</h2><p><img src=/p/react-basic/assets/image-20240126150834095.png width=1364 height=501 srcset="/p/react-basic/assets/image-20240126150834095_hu1f48e14669ea185e5e282b166e2c3341_92956_480x0_resize_box_3.png 480w, /p/react-basic/assets/image-20240126150834095_hu1f48e14669ea185e5e282b166e2c3341_92956_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20240126150834095 class=gallery-image data-flex-grow=272 data-flex-basis=653px></p><p><img src=/p/react-basic/assets/image-20240126151520287.png width=1159 height=459 srcset="/p/react-basic/assets/image-20240126151520287_hu3d0f5925f8f222ceeed6b4edf877e073_71257_480x0_resize_box_3.png 480w, /p/react-basic/assets/image-20240126151520287_hu3d0f5925f8f222ceeed6b4edf877e073_71257_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20240126151520287 class=gallery-image data-flex-grow=252 data-flex-basis=606px></p><h1 id=二jsx基础><a href=#%e4%ba%8cjsx%e5%9f%ba%e7%a1%80>#</a>
二、JSX基础</h1><h2 id=1-识别js表达式><a href=#1-%e8%af%86%e5%88%abjs%e8%a1%a8%e8%be%be%e5%bc%8f>#</a>
1. 识别js表达式</h2><p>在JSX中可以通过 大括号语法{} 识别 JavaScript中的表达式，比如常见的变量、函数调用、方法调用等等。</p><ol><li><p>使用引号传递字符串</p></li><li><p>使用JavaScript变量</p></li><li><p>函数调用和方法调用</p></li><li><p>使用JavaScript对象</p></li></ol><blockquote><p>App.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>count</span> <span class=o>=</span> <span class=mi>100</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>getName</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=s1>&#39;react&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=nx>div</span> <span class=nx>className</span><span class=o>=</span><span class=s2>&#34;App&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span> <span class=nx>is</span> <span class=nx>react</span> <span class=nx>App</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=cm>/* 使用引号传递字符串 */</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=s1>&#39;this is mesages&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=cm>/* 识别js变量 */</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=nx>count</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=cm>/* 函数调用 */</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=nx>getName</span><span class=p>()}</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=cm>/* 方法调用 */</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=k>new</span> <span class=nb>Date</span><span class=p>().</span><span class=nx>getDate</span><span class=p>()}</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=cm>/* 使用js对象 */</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>div</span> <span class=nx>style</span><span class=o>=</span><span class=p>{{</span><span class=nx>color</span><span class=o>:</span><span class=s1>&#39;red&#39;</span><span class=p>}}</span><span class=o>&gt;</span><span class=k>this</span> <span class=nx>is</span> <span class=nx>div</span><span class=o>&lt;</span><span class=err>/div&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=err>/div&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span><span class=p>;</span>
</span></span></code></pre></div><p>注意：if语句、switch语句、变量声明属于语句，不是表达式，不能出现在{}中</p><h2 id=2-jsx中实现列表渲染><a href=#2-jsx%e4%b8%ad%e5%ae%9e%e7%8e%b0%e5%88%97%e8%a1%a8%e6%b8%b2%e6%9f%93>#</a>
2. JSX中实现列表渲染</h2><p>语法：在JSX中可以使用原生JS中的map方法遍历渲染列表</p><blockquote><p>App.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>list</span><span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span><span class=nx>id</span><span class=o>:</span><span class=mi>1001</span><span class=p>,</span><span class=nx>name</span><span class=o>:</span><span class=s1>&#39;Vue&#39;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span><span class=nx>id</span><span class=o>:</span><span class=mi>1002</span><span class=p>,</span><span class=nx>name</span><span class=o>:</span><span class=s1>&#39;React&#39;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span><span class=nx>id</span><span class=o>:</span><span class=mi>1003</span><span class=p>,</span><span class=nx>name</span><span class=o>:</span><span class=s1>&#39;Angular&#39;</span><span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=nx>div</span> <span class=nx>className</span><span class=o>=</span><span class=s2>&#34;App&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=cm>/* 渲染列表 */</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=cm>/* map 循环哪个结构 return结构 */</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=cm>/* 注意事项：加上一个独一无二的key、字符串或者number */</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=cm>/* key的作用：React框架内部使用，提升更新性能的 */</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>ul</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=nx>list</span><span class=p>.</span><span class=nx>map</span><span class=p>(</span><span class=nx>item</span><span class=p>=&gt;</span><span class=o>&lt;</span><span class=nx>li</span> <span class=nx>key</span><span class=o>=</span><span class=p>{</span><span class=nx>item</span><span class=p>.</span><span class=nx>id</span><span class=p>}</span><span class=o>&gt;</span><span class=p>{</span><span class=nx>item</span><span class=p>.</span><span class=nx>name</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/li&gt;)}</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=err>/ul&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=err>/div&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span><span class=p>;</span>
</span></span></code></pre></div><h2 id=3-条件渲染><a href=#3-%e6%9d%a1%e4%bb%b6%e6%b8%b2%e6%9f%93>#</a>
3. 条件渲染</h2><p>语法：在React中，可以通过逻辑与运算符&&、三元表达式（?:）实现基础的条件渲染</p><blockquote><p>App.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>isLogin</span> <span class=o>=</span> <span class=kc>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=nx>div</span> <span class=nx>className</span><span class=o>=</span><span class=s2>&#34;App&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=cm>/* 逻辑与 &amp;&amp; */</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=nx>isLogin</span><span class=o>&amp;&amp;&lt;</span><span class=nx>span</span><span class=o>&gt;</span><span class=k>this</span> <span class=nx>is</span> <span class=nx>span</span><span class=o>&lt;</span><span class=err>/span&gt;}</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=cm>/* 三元运算 */</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=nx>isLogin</span> <span class=o>?</span> <span class=o>&lt;</span><span class=nx>span</span><span class=o>&gt;</span><span class=nx>jack</span><span class=o>&lt;</span><span class=err>/span&gt;:&lt;span&gt;loading&lt;/span&gt;}</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=err>/div&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span><span class=p>;</span>
</span></span></code></pre></div><h2 id=4-复杂条件渲染><a href=#4-%e5%a4%8d%e6%9d%82%e6%9d%a1%e4%bb%b6%e6%b8%b2%e6%9f%93>#</a>
4. 复杂条件渲染</h2><blockquote><p>App.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>articleType</span> <span class=o>=</span> <span class=mi>2</span><span class=p>;</span> <span class=c1>// 0 1 3
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>//定义核心函数（根据文章类型返回不同的JSX模板
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>getArticleTem</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>articleType</span> <span class=o>===</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=o>&lt;</span><span class=nx>div</span><span class=o>&gt;</span><span class=nx>我是无图模式</span><span class=o>&lt;</span><span class=err>/div&gt;;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=nx>articleType</span> <span class=o>===</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=o>&lt;</span><span class=nx>div</span><span class=o>&gt;</span><span class=nx>我是单图模式</span><span class=o>&lt;</span><span class=err>/div&gt;;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=o>&lt;</span><span class=nx>div</span><span class=o>&gt;</span><span class=nx>我是三图模式</span><span class=o>&lt;</span><span class=err>/div&gt;;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=nx>div</span> <span class=nx>className</span><span class=o>=</span><span class=s2>&#34;App&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=cm>/* 调用函数渲染不同的模板 */</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=nx>getArticleTem</span><span class=p>()}</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=err>/div&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span><span class=p>;</span>
</span></span></code></pre></div><h2 id=5-react中的事件绑定><a href=#5-react%e4%b8%ad%e7%9a%84%e4%ba%8b%e4%bb%b6%e7%bb%91%e5%ae%9a>#</a>
5. React中的事件绑定</h2><p>语法：on + 事件名称 = { 事件处理程序 }，整体上遵循驼峰命名法</p><blockquote><p>App.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>clickHandler1</span> <span class=o>=</span> <span class=p>(</span><span class=nx>e</span><span class=p>)=&gt;{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;button按钮点击了&#39;</span><span class=p>,</span><span class=nx>e</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>clickHandler2</span> <span class=o>=</span> <span class=p>(</span><span class=nx>param</span><span class=p>)=&gt;{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;button按钮点击了&#39;</span><span class=p>,</span><span class=nx>param</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>clickHandler3</span> <span class=o>=</span> <span class=p>(</span><span class=nx>param</span><span class=p>,</span><span class=nx>e</span><span class=p>)=&gt;{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;button按钮点击了&#39;</span><span class=p>,</span><span class=nx>param</span><span class=p>,</span><span class=nx>e</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;&gt;</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>button</span> <span class=nx>onClick</span><span class=o>=</span><span class=p>{</span><span class=nx>clickHandler1</span><span class=p>}</span><span class=o>&gt;</span><span class=nx>click</span> <span class=nx>me1</span><span class=o>&lt;</span><span class=err>/button&gt;</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>button</span> <span class=nx>onClick</span><span class=o>=</span><span class=p>{()=&gt;</span><span class=nx>clickHandler2</span><span class=p>(</span><span class=s1>&#39;jack&#39;</span><span class=p>)}</span><span class=o>&gt;</span><span class=nx>click</span> <span class=nx>me2</span><span class=o>&lt;</span><span class=err>/button&gt;</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>button</span> <span class=nx>onClick</span><span class=o>=</span><span class=p>{(</span><span class=nx>e</span><span class=p>)=&gt;</span><span class=nx>clickHandler3</span><span class=p>(</span><span class=s1>&#39;jack&#39;</span><span class=p>,</span><span class=nx>e</span><span class=p>)}</span><span class=o>&gt;</span><span class=nx>click</span> <span class=nx>me3</span><span class=o>&lt;</span><span class=err>/button&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=err>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span><span class=p>;</span>
</span></span></code></pre></div><h2 id=6-react中的组件><a href=#6-react%e4%b8%ad%e7%9a%84%e7%bb%84%e4%bb%b6>#</a>
6. React中的组件</h2><p>概念：一个组件就是用户界面的一部分，它可以有自己的逻辑和外观，组件之间可以互相嵌套，也可以复用多次</p><p><img src=/p/react-basic/assets/image-20240126155203830.png width=1258 height=465 srcset="/p/react-basic/assets/image-20240126155203830_hu5b52ab6d8e5cd7df5813a1279db7f127_40630_480x0_resize_box_3.png 480w, /p/react-basic/assets/image-20240126155203830_hu5b52ab6d8e5cd7df5813a1279db7f127_40630_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20240126155203830 class=gallery-image data-flex-grow=270 data-flex-basis=649px></p><p>组件化开发可以让开发者像搭积木一样构建一个完整的庞大的应用。</p><h3 id=61-react组件><a href=#61-react%e7%bb%84%e4%bb%b6>#</a>
6.1 React组件</h3><p>在React中，一个组件就是首字母大写的函数，内部存放了组件的逻辑和视图UI, 渲染组件只需要把组件当成标签书写即可。</p><blockquote><p>App.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>Button</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 业务逻辑组件逻辑
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>return</span> <span class=o>&lt;</span><span class=nx>button</span><span class=o>&gt;</span><span class=nx>click</span> <span class=nx>me</span><span class=o>!&lt;</span><span class=err>/button&gt;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=cm>/* 自闭和 */</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>Button</span><span class=o>/&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=cm>/* 成对标签 */</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>Button</span><span class=o>&gt;&lt;</span><span class=err>/Button&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=err>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span><span class=p>;</span>
</span></span></code></pre></div><h2 id=7-usestate><a href=#7-usestate>#</a>
7. useState</h2><p>useState 是一个 React Hook（函数），它允许我们向组件添加一个状态变量, 从而控制影响组件的渲染结果。</p><p><img src=/p/react-basic/assets/image-20240207092536768.png width=1657 height=348 srcset="/p/react-basic/assets/image-20240207092536768_huc88c3efb682f0725683b8b4b1bdc39fd_128149_480x0_resize_box_3.png 480w, /p/react-basic/assets/image-20240207092536768_huc88c3efb682f0725683b8b4b1bdc39fd_128149_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20240207092536768 class=gallery-image data-flex-grow=476 data-flex-basis=1142px></p><h3 id=71-usestate基础使用><a href=#71-usestate%e5%9f%ba%e7%a1%80%e4%bd%bf%e7%94%a8>#</a>
7.1 useState基础使用</h3><blockquote><p>App.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>useState</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;react&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 1. 调用useState 添加一个状态变量
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// count 状态变量
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// setCount 修改状态变量的方法
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=p>[</span><span class=nx>count</span><span class=p>,</span><span class=nx>setCount</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 2. 点击事件回调
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>clickHandlerCallback</span><span class=o>=</span><span class=p>()=&gt;{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 作用1. 用传入的新值需改count
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 2.重新使用新的count渲染ui
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>setCount</span><span class=p>(</span><span class=nx>count</span><span class=o>+</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;&gt;</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>button</span> <span class=nx>onClick</span><span class=o>=</span><span class=p>{</span><span class=nx>clickHandlerCallback</span><span class=p>}</span><span class=o>&gt;</span><span class=p>{</span><span class=nx>count</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/button&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=err>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span><span class=p>;</span>
</span></span></code></pre></div><h3 id=72-修改状态的规则><a href=#72-%e4%bf%ae%e6%94%b9%e7%8a%b6%e6%80%81%e7%9a%84%e8%a7%84%e5%88%99>#</a>
7.2 修改状态的规则</h3><p>在React中，状态被认为是只读的，我们应该始终<code>替换它</code>而不是<code>修改它</code>，直接修改状态不能引发视图更新</p><p><img src=/p/react-basic/assets/image-20240207093546889.png width=1551 height=449 srcset="/p/react-basic/assets/image-20240207093546889_hu76be0e39e5cc96f628b334a36a762618_250869_480x0_resize_box_3.png 480w, /p/react-basic/assets/image-20240207093546889_hu76be0e39e5cc96f628b334a36a762618_250869_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20240207093546889 class=gallery-image data-flex-grow=345 data-flex-basis=829px></p><h2 id=8-组件的样式处理><a href=#8-%e7%bb%84%e4%bb%b6%e7%9a%84%e6%a0%b7%e5%bc%8f%e5%a4%84%e7%90%86>#</a>
8. 组件的样式处理</h2><p>React组件基础的样式控制有俩种方式：</p><ol><li><p>行内样式（不推荐）</p><p><img src=/p/react-basic/assets/image-20240207094015751.png width=627 height=138 srcset="/p/react-basic/assets/image-20240207094015751_hu2dd255ae5c4d7d5a275c76d6e18fe56d_30331_480x0_resize_box_3.png 480w, /p/react-basic/assets/image-20240207094015751_hu2dd255ae5c4d7d5a275c76d6e18fe56d_30331_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20240207094015751 class=gallery-image data-flex-grow=454 data-flex-basis=1090px></p></li><li><p>class类名控制</p></li></ol><p><img src=/p/react-basic/assets/image-20240207094153844.png width=962 height=377 srcset="/p/react-basic/assets/image-20240207094153844_hu562e731f3f35092787e1172b258dd550_62476_480x0_resize_box_3.png 480w, /p/react-basic/assets/image-20240207094153844_hu562e731f3f35092787e1172b258dd550_62476_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20240207094153844 class=gallery-image data-flex-grow=255 data-flex-basis=612px></p><blockquote><p>app.css</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=p>.</span><span class=nx>foo</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>color</span><span class=o>:</span> <span class=nx>red</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>font</span><span class=o>-</span><span class=nx>size</span><span class=o>:</span> <span class=mi>20</span><span class=nx>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><blockquote><p>App.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// 导入样式
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=s1>&#39;./app.css&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>style</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>color</span><span class=o>:</span><span class=s1>&#39;red&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>fontSize</span><span class=o>:</span><span class=s1>&#39;50px&#39;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=cm>/* 行内样式控制 */</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>span</span> <span class=nx>style</span><span class=o>=</span><span class=p>{</span><span class=nx>style</span><span class=p>}</span><span class=o>&gt;</span><span class=k>this</span> <span class=nx>is</span> <span class=nx>line</span> <span class=nx>style</span><span class=o>&lt;</span><span class=err>/span&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=cm>/* 通过class类名控制 */</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>span</span> <span class=nx>className</span><span class=o>=</span><span class=s2>&#34;foo&#34;</span><span class=o>&gt;</span><span class=k>this</span> <span class=nx>is</span> <span class=kr>class</span> <span class=nx>control</span> <span class=nx>style</span><span class=o>&lt;</span><span class=err>/span&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=err>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span><span class=p>;</span>
</span></span></code></pre></div><h2 id=9-受控表单绑定><a href=#9-%e5%8f%97%e6%8e%a7%e8%a1%a8%e5%8d%95%e7%bb%91%e5%ae%9a>#</a>
9. 受控表单绑定</h2><p>概念：使用React组件的状态（useState）控制表单的状态</p><p><img src=/p/react-basic/assets/image-20240207102327605.png width=983 height=196 srcset="/p/react-basic/assets/image-20240207102327605_hu62c117dd8a30d7736d130c715c77e02b_30147_480x0_resize_box_3.png 480w, /p/react-basic/assets/image-20240207102327605_hu62c117dd8a30d7736d130c715c77e02b_30147_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20240207102327605 class=gallery-image data-flex-grow=501 data-flex-basis=1203px></p><p><img src=/p/react-basic/assets/image-20240207102344985.png width=916 height=381 srcset="/p/react-basic/assets/image-20240207102344985_hu8a7c7ddb37fa3c3d1ac4492e6b8bbffe_119269_480x0_resize_box_3.png 480w, /p/react-basic/assets/image-20240207102344985_hu8a7c7ddb37fa3c3d1ac4492e6b8bbffe_119269_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20240207102344985 class=gallery-image data-flex-grow=240 data-flex-basis=577px></p><blockquote><p>App.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>useState</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;react&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=c1>// 1. 声明一个react状态 - useState
</span></span></span><span class=line><span class=cl><span class=c1>// 2. 核心绑定流程
</span></span></span><span class=line><span class=cl><span class=c1>// 2.1 通过value属性绑定react状态
</span></span></span><span class=line><span class=cl><span class=c1>// 2.2 绑定onChange事件，通过事件参数e拿到输入框最新的值，反向修改到react状态
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>[</span><span class=nx>value</span><span class=p>,</span><span class=nx>setValue</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;&gt;</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>input</span> <span class=nx>value</span><span class=o>=</span><span class=p>{</span><span class=nx>value</span><span class=p>}</span> <span class=nx>onChange</span><span class=o>=</span><span class=p>{(</span><span class=nx>e</span><span class=p>)=&gt;</span><span class=nx>setValue</span><span class=p>(</span><span class=nx>e</span><span class=p>.</span><span class=nx>target</span><span class=p>.</span><span class=nx>value</span><span class=p>)}</span><span class=o>&gt;&lt;</span><span class=err>/input&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=err>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span><span class=p>;</span>
</span></span></code></pre></div><h2 id=10-react中获取dom><a href=#10-react%e4%b8%ad%e8%8e%b7%e5%8f%96dom>#</a>
10. React中获取DOM</h2><p>在 React 组件中获取/操作 DOM，需要使用 useRef React Hook钩子函数，分为两步：</p><ol><li><p>使用useRef创建 ref 对象，并与 JSX 绑定</p><p><img src=/p/react-basic/assets/image-20240207103043702.png width=893 height=198 srcset="/p/react-basic/assets/image-20240207103043702_hu962bac718c2bb464aca61c7fc5e04cfb_109546_480x0_resize_box_3.png 480w, /p/react-basic/assets/image-20240207103043702_hu962bac718c2bb464aca61c7fc5e04cfb_109546_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20240207103043702 class=gallery-image data-flex-grow=451 data-flex-basis=1082px></p></li><li><p>在<code>DOM可用时</code>，通过 inputRef.current 拿到 DOM 对象</p></li></ol><p><img src=/p/react-basic/assets/image-20240207103051769.png width=882 height=105 srcset="/p/react-basic/assets/image-20240207103051769_hue06382a73c53131a8938f961e415a488_68911_480x0_resize_box_3.png 480w, /p/react-basic/assets/image-20240207103051769_hue06382a73c53131a8938f961e415a488_68911_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20240207103051769 class=gallery-image data-flex-grow=840 data-flex-basis=2016px></p><blockquote><p>App.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span><span class=nx>useRef</span><span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;react&#34;</span>
</span></span><span class=line><span class=cl><span class=c1>// 1. useRef 生成ref对象，绑定到dom标签上
</span></span></span><span class=line><span class=cl><span class=c1>// 2. dom可用时，ref.current获取dom
</span></span></span><span class=line><span class=cl><span class=c1>// 渲染完毕之后dom生成之后才可用
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>inputRef</span> <span class=o>=</span> <span class=nx>useRef</span><span class=p>(</span><span class=kc>null</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=nx>input</span> <span class=nx>ref</span><span class=o>=</span><span class=p>{</span><span class=nx>inputRef</span><span class=p>}</span> <span class=nx>type</span><span class=o>=</span><span class=s2>&#34;text&#34;</span><span class=o>&gt;&lt;</span><span class=err>/input&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=nx>button</span> <span class=nx>onClick</span><span class=o>=</span><span class=p>{()=&gt;</span><span class=nx>console</span><span class=p>.</span><span class=nx>dir</span><span class=p>(</span><span class=nx>inputRef</span><span class=p>.</span><span class=nx>current</span><span class=p>)}</span><span class=o>&gt;</span><span class=nx>获取dom</span><span class=o>&lt;</span><span class=err>/button&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=err>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span><span class=p>;</span>
</span></span></code></pre></div><h2 id=11-组件通信><a href=#11-%e7%bb%84%e4%bb%b6%e9%80%9a%e4%bf%a1>#</a>
11. 组件通信</h2><p>概念：组件通信就是组件之间的数据传递，根据组件嵌套关系的不同，有不同的通信方法</p><p><img src=/p/react-basic/assets/image-20240207112058046.png width=1099 height=527 srcset="/p/react-basic/assets/image-20240207112058046_hu992dc19e81e612a74108adba98a97a70_72698_480x0_resize_box_3.png 480w, /p/react-basic/assets/image-20240207112058046_hu992dc19e81e612a74108adba98a97a70_72698_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20240207112058046 class=gallery-image data-flex-grow=208 data-flex-basis=500px></p><h3 id=111-父传子><a href=#111-%e7%88%b6%e4%bc%a0%e5%ad%90>#</a>
11.1 父传子</h3><h4 id=1111-基础实现><a href=#1111-%e5%9f%ba%e7%a1%80%e5%ae%9e%e7%8e%b0>#</a>
11.1.1 基础实现</h4><p><img src=/p/react-basic/assets/image-20240207112135463.png width=1144 height=516 srcset="/p/react-basic/assets/image-20240207112135463_hudadc494ef9e0c47ecb26bd1ca4483f5c_642948_480x0_resize_box_3.png 480w, /p/react-basic/assets/image-20240207112135463_hudadc494ef9e0c47ecb26bd1ca4483f5c_642948_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20240207112135463 class=gallery-image data-flex-grow=221 data-flex-basis=532px></p><p>实现步骤：</p><ol><li><p>父组件传递数据 - 在子组件标签上绑定属性</p></li><li><p>子组件接收数据 - 子组件通过props参数接收数据</p></li></ol><blockquote><p>App.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// 1. 父组件传递数据 - 在子组件标签上绑定属性
</span></span></span><span class=line><span class=cl><span class=c1>// 2. 子组件接收数据 - 子组件通过props参数接收数据
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>Son</span><span class=p>(</span><span class=nx>props</span><span class=p>){</span>
</span></span><span class=line><span class=cl>  <span class=c1>// props：对象里面包含了父组件传递过来的所有的数据
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>props</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=o>&lt;</span><span class=nx>div</span><span class=o>&gt;</span><span class=k>this</span> <span class=nx>is</span> <span class=nx>son</span><span class=p>,{</span><span class=nx>props</span><span class=p>.</span><span class=nx>name</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/div&gt;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>name</span> <span class=o>=</span> <span class=s1>&#39;this is app name&#39;</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;&gt;</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>Son</span> <span class=nx>name</span><span class=o>=</span><span class=p>{</span><span class=nx>name</span><span class=p>}</span><span class=o>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=err>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span><span class=p>;</span>
</span></span></code></pre></div><h4 id=1112-父传子-props说明><a href=#1112-%e7%88%b6%e4%bc%a0%e5%ad%90-props%e8%af%b4%e6%98%8e>#</a>
11.1.2 父传子-props说明</h4><blockquote><p>props可传递任意的数据</p></blockquote><p>​ 数字、字符串、布尔值、数组、对象、函数、JSX</p><blockquote><p>props是只读对象</p></blockquote><p>​ 子组件<code>只能读取props中的数据，不能直接进行修改,</code> 父组件的数据只能由父组件修改</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>Son</span><span class=p>(</span><span class=nx>props</span><span class=p>){</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>props</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=o>&lt;</span><span class=nx>div</span><span class=o>&gt;</span><span class=k>this</span> <span class=nx>is</span> <span class=nx>son</span><span class=p>,{</span><span class=nx>props</span><span class=p>.</span><span class=nx>name</span><span class=p>},</span><span class=nx>jsx</span><span class=o>:</span><span class=p>{</span><span class=nx>props</span><span class=p>.</span><span class=nx>child</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/div&gt;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>name</span> <span class=o>=</span> <span class=s1>&#39;this is app name&#39;</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;&gt;</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>Son</span>
</span></span><span class=line><span class=cl>      <span class=nx>name</span><span class=o>=</span><span class=p>{</span><span class=nx>name</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=nx>age</span><span class=o>=</span><span class=p>{</span><span class=mi>18</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=nx>isTrue</span><span class=o>=</span><span class=p>{</span><span class=kc>false</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=nx>list</span><span class=o>=</span><span class=p>{[</span><span class=s1>&#39;vue&#39;</span><span class=p>,</span><span class=s1>&#39;react&#39;</span><span class=p>]}</span>
</span></span><span class=line><span class=cl>      <span class=nx>obj</span><span class=o>=</span><span class=p>{{</span><span class=nx>name</span><span class=o>:</span><span class=s1>&#39;jack&#39;</span><span class=p>}}</span>
</span></span><span class=line><span class=cl>      <span class=nx>cb</span><span class=o>=</span><span class=p>{()=&gt;</span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=mi>123</span><span class=p>)}</span>
</span></span><span class=line><span class=cl>      <span class=nx>child</span><span class=o>=</span><span class=p>{</span><span class=o>&lt;</span><span class=nx>span</span><span class=o>&gt;</span><span class=k>this</span> <span class=nx>is</span> <span class=nx>span</span><span class=o>&lt;</span><span class=err>/span&gt;}</span>
</span></span><span class=line><span class=cl>      <span class=err>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=err>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span><span class=p>;</span>
</span></span></code></pre></div><h4 id=1113-父传子-children说明><a href=#1113-%e7%88%b6%e4%bc%a0%e5%ad%90-children%e8%af%b4%e6%98%8e>#</a>
11.1.3 父传子-children说明</h4><p>场景：当我们把内容嵌套在子组件标签中时，父组件会自动在名为children的prop属性中接收该内容</p><p><img src=/p/react-basic/assets/image-20240207113045176.png width=710 height=568 srcset="/p/react-basic/assets/image-20240207113045176_hu65b6481664a5d299eac53642799750c9_98289_480x0_resize_box_3.png 480w, /p/react-basic/assets/image-20240207113045176_hu65b6481664a5d299eac53642799750c9_98289_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20240207113045176 class=gallery-image data-flex-grow=125 data-flex-basis=300px></p><blockquote><p>App.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>Son</span><span class=p>(</span><span class=nx>props</span><span class=p>){</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>props</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=o>&lt;</span><span class=nx>div</span><span class=o>&gt;</span><span class=k>this</span> <span class=nx>is</span> <span class=nx>son</span><span class=p>,{</span><span class=nx>props</span><span class=p>.</span><span class=nx>children</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/div&gt;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;&gt;</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>Son</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=o>&lt;</span><span class=nx>span</span><span class=o>&gt;</span><span class=k>this</span> <span class=nx>is</span> <span class=nx>span</span><span class=o>&lt;</span><span class=err>/span&gt;</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=err>/Son&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=err>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span><span class=p>;</span>
</span></span></code></pre></div><h3 id=112-子传父><a href=#112-%e5%ad%90%e4%bc%a0%e7%88%b6>#</a>
11.2 子传父</h3><p><img src=/p/react-basic/assets/image-20240207113720971.png width=852 height=429 srcset="/p/react-basic/assets/image-20240207113720971_hub98882a35398d4126d0f4f94fe340131_400831_480x0_resize_box_3.png 480w, /p/react-basic/assets/image-20240207113720971_hub98882a35398d4126d0f4f94fe340131_400831_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20240207113720971 class=gallery-image data-flex-grow=198 data-flex-basis=476px></p><p><img src=/p/react-basic/assets/image-20240207113735433.png width=1433 height=328 srcset="/p/react-basic/assets/image-20240207113735433_hu4fc70849be61fc95522c1f4e50cb6fee_144519_480x0_resize_box_3.png 480w, /p/react-basic/assets/image-20240207113735433_hu4fc70849be61fc95522c1f4e50cb6fee_144519_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20240207113735433 class=gallery-image data-flex-grow=436 data-flex-basis=1048px></p><blockquote><p>App.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>Son</span><span class=p>({</span><span class=nx>onGetMsg</span><span class=p>}){</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>sonMsg</span> <span class=o>=</span> <span class=s1>&#39;this is son msg&#39;</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=o>&lt;</span><span class=nx>div</span><span class=o>&gt;</span><span class=k>this</span> <span class=nx>is</span> <span class=nx>son</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=nx>button</span> <span class=nx>onClick</span><span class=o>=</span><span class=p>{()=&gt;</span><span class=nx>onGetMsg</span><span class=p>(</span><span class=nx>sonMsg</span><span class=p>)}</span><span class=o>&gt;</span><span class=nx>senMsg</span><span class=o>&lt;</span><span class=err>/button&gt;</span>
</span></span><span class=line><span class=cl>  <span class=o>&lt;</span><span class=err>/div&gt;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>getMsg</span> <span class=o>=</span> <span class=p>(</span><span class=nx>msg</span><span class=p>)=&gt;{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>msg</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;&gt;</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>Son</span> <span class=nx>onGetMsg</span><span class=o>=</span><span class=p>{</span><span class=nx>getMsg</span><span class=p>}</span><span class=o>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=err>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span><span class=p>;</span>
</span></span></code></pre></div><h3 id=113-使用状态提升实现兄弟组件通信><a href=#113-%e4%bd%bf%e7%94%a8%e7%8a%b6%e6%80%81%e6%8f%90%e5%8d%87%e5%ae%9e%e7%8e%b0%e5%85%84%e5%bc%9f%e7%bb%84%e4%bb%b6%e9%80%9a%e4%bf%a1>#</a>
11.3 使用状态提升实现兄弟组件通信</h3><p><img src=/p/react-basic/assets/image-20240207114441428.png width=811 height=476 srcset="/p/react-basic/assets/image-20240207114441428_hu056fea7332c18a9291b00849e4257771_438629_480x0_resize_box_3.png 480w, /p/react-basic/assets/image-20240207114441428_hu056fea7332c18a9291b00849e4257771_438629_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20240207114441428 class=gallery-image data-flex-grow=170 data-flex-basis=408px></p><p>实现思路：借助“状态提升”机制，通过父组件进行兄弟组件之间的数据传递</p><ol><li><p>A组件先通过子传父的方式把数据传给父组件App</p></li><li><p>App拿到数据后通过父传子的方式再传递给B组件</p></li></ol><blockquote><p>App.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>useState</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;react&#34;</span>
</span></span><span class=line><span class=cl><span class=c1>// 1. 通过子传父 A-&gt;App
</span></span></span><span class=line><span class=cl><span class=c1>// 2. 通过父传子 App-&gt;B
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>A</span><span class=p>({</span><span class=nx>onGetAData</span><span class=p>}){</span>
</span></span><span class=line><span class=cl>  <span class=c1>// A 组件中数据
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>name</span> <span class=o>=</span> <span class=s1>&#39;this is A name&#39;</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=nx>div</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span> <span class=nx>is</span> <span class=nx>A</span> <span class=nx>component</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>button</span> <span class=nx>onClick</span><span class=o>=</span><span class=p>{()=&gt;</span><span class=nx>onGetAData</span><span class=p>(</span><span class=nx>name</span><span class=p>)}</span><span class=o>&gt;</span><span class=nx>send</span><span class=o>&lt;</span><span class=err>/button&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=err>/div&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>B</span><span class=p>(</span><span class=nx>props</span><span class=p>){</span>
</span></span><span class=line><span class=cl>  <span class=c1>// A 组件中数据
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=nx>div</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span> <span class=nx>is</span> <span class=nx>B</span> <span class=nx>component</span><span class=p>,{</span><span class=nx>props</span><span class=p>.</span><span class=nx>aMsg</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=err>/div&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>[</span><span class=nx>aMsg</span><span class=p>,</span><span class=nx>setAMsg</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>getAData</span><span class=o>=</span><span class=p>(</span><span class=nx>aData</span><span class=p>)=&gt;{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>aData</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>setAMsg</span><span class=p>(</span><span class=nx>aData</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;&gt;</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span> <span class=nx>is</span> <span class=nx>App</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=nx>A</span> <span class=nx>onGetAData</span><span class=o>=</span><span class=p>{</span><span class=nx>getAData</span><span class=p>}</span><span class=o>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=nx>B</span> <span class=nx>aMsg</span><span class=o>=</span><span class=p>{</span><span class=nx>aMsg</span><span class=p>}</span><span class=o>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=err>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span><span class=p>;</span>
</span></span></code></pre></div><h3 id=114-使用context机制跨层级组件通信><a href=#114-%e4%bd%bf%e7%94%a8context%e6%9c%ba%e5%88%b6%e8%b7%a8%e5%b1%82%e7%ba%a7%e7%bb%84%e4%bb%b6%e9%80%9a%e4%bf%a1>#</a>
11.4 使用Context机制跨层级组件通信</h3><p><img src=/p/react-basic/assets/image-20240207114350347.png width=1834 height=486 srcset="/p/react-basic/assets/image-20240207114350347_hu7f7a7de5856bf1f96e1fbc4c660a8539_547228_480x0_resize_box_3.png 480w, /p/react-basic/assets/image-20240207114350347_hu7f7a7de5856bf1f96e1fbc4c660a8539_547228_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20240207114350347 class=gallery-image data-flex-grow=377 data-flex-basis=905px></p><p>实现步骤：</p><ol><li><p>使用createContext方法创建一个上下文对象Ctx</p></li><li><p>在顶层组件（App）中通过 Ctx.Provider 组件提供数据</p></li><li><p>在底层组件（B）中通过 useContext 钩子函数获取消费数据</p></li></ol><blockquote><p>App.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// App-&gt;A-&gt;B
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>useContext</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;react&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>createContext</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;react&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 1. createContext方法创建一个上下文对象
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>MsgContext</span> <span class=o>=</span> <span class=nx>createContext</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>A</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=nx>div</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span> <span class=nx>is</span> <span class=nx>A</span> <span class=nx>component</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>B</span><span class=o>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=err>/div&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>// 3. 在底层组件，通过useContext钩子函数使用数据
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>B</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>msg</span> <span class=o>=</span> <span class=nx>useContext</span><span class=p>(</span><span class=nx>MsgContext</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=nx>div</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span> <span class=nx>is</span> <span class=nx>B</span> <span class=nx>component</span><span class=p>,{</span><span class=nx>msg</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=err>/div&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>msg</span> <span class=o>=</span> <span class=s1>&#39;this is app msg&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=cm>/* 2. 在顶层组件，通过Provider组件提供数据 */</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=nx>MsgContext</span><span class=p>.</span><span class=nx>Provider</span> <span class=nx>value</span><span class=o>=</span><span class=p>{</span><span class=nx>msg</span><span class=p>}</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span> <span class=nx>is</span> <span class=nx>App</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>A</span><span class=o>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=err>/MsgContext.Provider&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=err>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span><span class=p>;</span>
</span></span></code></pre></div><h2 id=12-useeffect的使用><a href=#12-useeffect%e7%9a%84%e4%bd%bf%e7%94%a8>#</a>
12. useEffect的使用</h2><p>​ useEffect是一个React Hook函数，用于在React组件中创建不是由事件引起而是由渲染本身引起的操作（副作用）, 比</p><p>如发送AJAX请求，更改DOM等等。</p><p><img src=/p/react-basic/assets/image-20240207164207219.png width=722 height=519 srcset="/p/react-basic/assets/image-20240207164207219_hu1b68b3ad70c0519f15978e0cdbd35b77_195975_480x0_resize_box_3.png 480w, /p/react-basic/assets/image-20240207164207219_hu1b68b3ad70c0519f15978e0cdbd35b77_195975_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20240207164207219 class=gallery-image data-flex-grow=139 data-flex-basis=333px></p><p>说明：上面的组件中没有发生任何的用户事件，<code>组件渲染完毕之后</code>就需要和服务器要数据，整个过程属于<code>“只由渲染引起的操作”</code></p><h3 id=121-useeffect-的基础使用><a href=#121-useeffect-%e7%9a%84%e5%9f%ba%e7%a1%80%e4%bd%bf%e7%94%a8>#</a>
12.1 useEffect 的基础使用</h3><p>需求：在组件渲染完毕之后，立刻从服务端获取频道列表数据并显示到页面中</p><p>语法：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>useEffect</span><span class=p>(()=&gt;{},[])</span>
</span></span></code></pre></div><p>参数1是一个函数，可以把它叫做副作用函数，在函数内部可以放置要执行的操作</p><p>参数2是一个数组（可选参），在数组里放置依赖项，不同依赖项会影响第一个参数函数的执行，`当是一个空数组的时候，副作用函数</p><p>只会在组件渲染完毕之后执行一次。`</p><p>接口地址：http://geek.itheima.net/v1_0/channels</p><blockquote><p>App.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>useState</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;react&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>useEffect</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;react&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>URL</span> <span class=o>=</span> <span class=s2>&#34;http://geek.itheima.net/v1_0/channels&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 创建一个状态数据
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=p>[</span><span class=nx>list</span><span class=p>,</span><span class=nx>setList</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>([])</span>
</span></span><span class=line><span class=cl>  <span class=nx>useEffect</span><span class=p>(()=&gt;{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 额外的操作，获取频道列表
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>async</span> <span class=kd>function</span> <span class=nx>getList</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>       <span class=kr>const</span> <span class=nx>res</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>fetch</span><span class=p>(</span><span class=nx>URL</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=kr>const</span> <span class=nx>jsonResp</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>res</span><span class=p>.</span><span class=nx>json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>       <span class=nx>setList</span><span class=p>(</span><span class=nx>jsonResp</span><span class=p>.</span><span class=nx>data</span><span class=p>.</span><span class=nx>channels</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>getList</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>},[])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;&gt;</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span> <span class=nx>is</span> <span class=nx>app</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>ul</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=nx>list</span><span class=p>.</span><span class=nx>map</span><span class=p>(</span><span class=nx>item</span><span class=p>=&gt;</span><span class=o>&lt;</span><span class=nx>li</span> <span class=nx>key</span><span class=o>=</span><span class=p>{</span><span class=nx>item</span><span class=p>.</span><span class=nx>id</span><span class=p>}</span><span class=o>&gt;</span><span class=p>{</span><span class=nx>item</span><span class=p>.</span><span class=nx>name</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/li&gt;)}</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=err>/ul&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=err>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span><span class=p>;</span>
</span></span></code></pre></div><h3 id=122-useeffect-依赖项参数说明><a href=#122-useeffect-%e4%be%9d%e8%b5%96%e9%a1%b9%e5%8f%82%e6%95%b0%e8%af%b4%e6%98%8e>#</a>
12.2 useEffect 依赖项参数说明</h3><p>useEffect副作用函数的执行时机存在多种情况，根据<code>传入依赖项的不同</code>，会有不同的执行表现。</p><div class=table-wrapper><table><thead><tr><th style=text-align:center><strong>依赖项</strong></th><th style=text-align:center><strong>副作用函数执行时机</strong></th></tr></thead><tbody><tr><td style=text-align:center>没有依赖项</td><td style=text-align:center>组件初始渲染 + 组件更新时执行</td></tr><tr><td style=text-align:center>空数组依赖项</td><td style=text-align:center>只在初始渲染时执行一次</td></tr><tr><td style=text-align:center>添加特定依赖项</td><td style=text-align:center>组件初始渲染 + 特性依赖项变化时执行</td></tr></tbody></table></div><h4 id=1221-没有依赖项><a href=#1221-%e6%b2%a1%e6%9c%89%e4%be%9d%e8%b5%96%e9%a1%b9>#</a>
12.2.1 没有依赖项</h4><blockquote><p>App.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>useState</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;react&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>useEffect</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;react&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>[</span><span class=nx>count</span><span class=p>,</span><span class=nx>setCount</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 1. 没有依赖项    组件初始渲染 + 组件更新时执行
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>useEffect</span><span class=p>(()=&gt;{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;副作用函数执行了&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;&gt;</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span> <span class=nx>is</span> <span class=nx>app</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>button</span> <span class=nx>onClick</span><span class=o>=</span><span class=p>{()=&gt;</span><span class=nx>setCount</span><span class=p>(</span><span class=nx>count</span><span class=o>+</span><span class=mi>1</span><span class=p>)}</span><span class=o>&gt;+</span><span class=p>{</span><span class=nx>count</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/button&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=err>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span><span class=p>;</span>
</span></span></code></pre></div><h4 id=1222-空数组依赖项><a href=#1222-%e7%a9%ba%e6%95%b0%e7%bb%84%e4%be%9d%e8%b5%96%e9%a1%b9>#</a>
12.2.2 空数组依赖项</h4><blockquote><p>App.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>useState</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;react&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>useEffect</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;react&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>[</span><span class=nx>count</span><span class=p>,</span><span class=nx>setCount</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 2. 空数组依赖项    只在初始渲染时执行一次
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>useEffect</span><span class=p>(()=&gt;{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;副作用函数执行了&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>},[])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;&gt;</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span> <span class=nx>is</span> <span class=nx>app</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>button</span> <span class=nx>onClick</span><span class=o>=</span><span class=p>{()=&gt;</span><span class=nx>setCount</span><span class=p>(</span><span class=nx>count</span><span class=o>+</span><span class=mi>1</span><span class=p>)}</span><span class=o>&gt;+</span><span class=p>{</span><span class=nx>count</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/button&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=err>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span><span class=p>;</span>
</span></span></code></pre></div><h4 id=1223-特定依赖项><a href=#1223-%e7%89%b9%e5%ae%9a%e4%be%9d%e8%b5%96%e9%a1%b9>#</a>
12.2.3 特定依赖项</h4><blockquote><p>App.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>import</span><span class=w> </span><span class=err>{ </span><span class=nn>useState</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=n>from</span><span class=w> </span><span class=s>&#34;react&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=err>{ </span><span class=nn>useEffect</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=n>from</span><span class=w> </span><span class=s>&#34;react&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>function</span><span class=w> </span><span class=nf>App</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=o>[</span><span class=n>count</span><span class=p>,</span><span class=n>setCount</span><span class=o>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>useState</span><span class=p>(</span><span class=n>0</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c1>// 3. 添加特定依赖项    组件初始渲染 + 特性依赖项变化时执行</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>useEffect</span><span class=p>(()</span><span class=o>=&gt;</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>console</span><span class=p>.</span><span class=na>log</span><span class=p>(</span><span class=s>&#34;副作用函数执行了&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>},</span><span class=o>[</span><span class=n>count</span><span class=o>]</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>return</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>&lt;&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=k>this</span><span class=w> </span><span class=n>is</span><span class=w> </span><span class=n>app</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=o>&lt;</span><span class=n>button</span><span class=w> </span><span class=n>onClick</span><span class=o>=</span><span class=p>{()</span><span class=o>=&gt;</span><span class=n>setCount</span><span class=p>(</span><span class=n>count</span><span class=o>+</span><span class=n>1</span><span class=p>)}</span><span class=o>&gt;+</span><span class=p>{</span><span class=n>count</span><span class=p>}</span><span class=o>&lt;/</span><span class=n>button</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>&lt;/&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=n>App</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><h3 id=123-useeffect--清除副作用><a href=#123-useeffect--%e6%b8%85%e9%99%a4%e5%89%af%e4%bd%9c%e7%94%a8>#</a>
12.3 useEffect — 清除副作用</h3><p>在useEffect中编写的<code>由渲染本身引起的对接组件外部的操作</code>，社区也经常把它叫做<code>副作用操作</code>，比如在useEffect中开</p><p>启了一个定时器，我们想在组件卸载时把这个定时器再清理掉，这个过程就是清理副作用。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>useEffect</span><span class=p>(()=&gt;{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 实现副作用操作逻辑
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=p>()=&gt;{</span>
</span></span><span class=line><span class=cl>        <span class=c1>//清除副作用逻辑
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>},[])</span>
</span></span></code></pre></div><p>说明：清除副作用的函数<code>最常见</code>的执行时机是在组件卸载时自动执行</p><p>需求：在Son组件渲染时开启一个定制器，卸载时清除这个定时器</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>useState</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;react&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>useEffect</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;react&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>Son</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 1. 渲染时开启一个定时器
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>useEffect</span><span class=p>(()=&gt;{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>timer</span> <span class=o>=</span> <span class=nx>setInterval</span><span class=p>(()=&gt;{</span>
</span></span><span class=line><span class=cl>      <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;定时器执行中&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span><span class=mi>1000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>()=&gt;{</span>
</span></span><span class=line><span class=cl>      <span class=c1>// 清除副作用（组件卸载时）
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=nx>clearInterval</span><span class=p>(</span><span class=nx>timer</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>},[])</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=o>&lt;</span><span class=nx>div</span><span class=o>&gt;</span><span class=k>this</span> <span class=nx>is</span> <span class=nx>son</span><span class=o>&lt;</span><span class=err>/div&gt;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 通过条件渲染模拟组件卸载
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=p>[</span><span class=nx>show</span><span class=p>,</span><span class=nx>setShow</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>(</span><span class=kc>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=nx>show</span> <span class=o>&amp;&amp;</span> <span class=o>&lt;</span><span class=nx>Son</span><span class=o>/&gt;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>button</span> <span class=nx>onClick</span><span class=o>=</span><span class=p>{()=&gt;</span><span class=nx>setShow</span><span class=p>(</span><span class=kc>false</span><span class=p>)}</span><span class=o>&gt;</span><span class=nx>卸载Son组件</span><span class=o>&lt;</span><span class=err>/button&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=err>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span><span class=p>;</span>
</span></span></code></pre></div><h2 id=13-自定义hook函数><a href=#13-%e8%87%aa%e5%ae%9a%e4%b9%89hook%e5%87%bd%e6%95%b0>#</a>
13. 自定义Hook函数</h2><p>概念：自定义Hook是以 <code>use 打头的函数</code>，通过自定义Hook函数可以用来实现<code>逻辑的封装和复用</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>useState</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;react&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>useToggle</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>[</span><span class=nx>value</span><span class=p>,</span><span class=nx>setValue</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>(</span><span class=kc>false</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>toggle</span><span class=o>=</span><span class=p>()=&gt;</span><span class=nx>setValue</span><span class=p>(</span><span class=o>!</span><span class=nx>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>value</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>toggle</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 封装自定义hook通用思路
</span></span></span><span class=line><span class=cl><span class=c1>// 1. 声明一个以use打头的函数；
</span></span></span><span class=line><span class=cl><span class=c1>// 2. 在函数体内封装可复用的逻辑（只要是可复用的逻辑）；
</span></span></span><span class=line><span class=cl><span class=c1>// 3. 把组件中用到的状态或者回调return出去（以对象或者数组）；
</span></span></span><span class=line><span class=cl><span class=c1>// 4. 在哪个组件中要用到这个逻辑，就执行这个函数，解构出来状态和回调进行使用。
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>{</span><span class=nx>value</span><span class=p>,</span><span class=nx>toggle</span><span class=p>}</span> <span class=o>=</span> <span class=nx>useToggle</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=nx>value</span> <span class=o>&amp;&amp;</span> <span class=o>&lt;</span><span class=nx>div</span><span class=o>&gt;</span><span class=k>this</span> <span class=nx>is</span> <span class=nx>dive</span><span class=o>&lt;</span><span class=err>/div&gt;}</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>button</span> <span class=nx>onClick</span><span class=o>=</span><span class=p>{</span><span class=nx>toggle</span><span class=p>}</span><span class=o>&gt;</span><span class=nx>toggle</span><span class=o>&lt;</span><span class=err>/button&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=err>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span><span class=p>;</span>
</span></span></code></pre></div><h2 id=14-react-hooks使用规则><a href=#14-react-hooks%e4%bd%bf%e7%94%a8%e8%a7%84%e5%88%99>#</a>
14. React Hooks使用规则</h2><blockquote><p>使用规则</p></blockquote><ol><li>只能在组件中或者其他自定义Hook函数中调用</li><li>只能在组件的顶层调用，不能嵌套在 if、for、其他函数中</li></ol><p><img src=/p/react-basic/assets/image-20240312163922912.png width=1563 height=329 srcset="/p/react-basic/assets/image-20240312163922912_huc4b251561fbf5a433a0f51a8f37e5b77_182270_480x0_resize_box_3.png 480w, /p/react-basic/assets/image-20240312163922912_huc4b251561fbf5a433a0f51a8f37e5b77_182270_1024x0_resize_box_3.png 1024w" loading=lazy alt=image-20240312163922912 class=gallery-image data-flex-grow=475 data-flex-basis=1140px></p><h1 id=三redux><a href=#%e4%b8%89redux>#</a>
三、Redux</h1><h2 id=1-redux介绍><a href=#1-redux%e4%bb%8b%e7%bb%8d>#</a>
1. Redux介绍</h2><blockquote><p>Redux 是React最常用的集中状态管理工具，类似于Vue中的Pinia（Vuex），可以独立于框架运行
作用：通过集中管理的方式管理应用的状态</p></blockquote><p><img src=/p/react-basic/assets/1.png width=1428 height=805 srcset="/p/react-basic/assets/1_hu98f6fd50a4f2e293a2be77495df51183_325303_480x0_resize_box_3.png 480w, /p/react-basic/assets/1_hu98f6fd50a4f2e293a2be77495df51183_325303_1024x0_resize_box_3.png 1024w" loading=lazy alt=image.png class=gallery-image data-flex-grow=177 data-flex-basis=425px>
<strong>为什么要使用Redux？</strong></p><ol><li>独立于组件，无视组件之间的层级关系，简化通信问题</li><li>单项数据流清晰，易于定位bug</li><li>调试工具配套良好，方便调试</li></ol><h2 id=2-redux快速体验><a href=#2-redux%e5%bf%ab%e9%80%9f%e4%bd%93%e9%aa%8c>#</a>
2. Redux快速体验</h2><h3 id=21-实现计数器><a href=#21-%e5%ae%9e%e7%8e%b0%e8%ae%a1%e6%95%b0%e5%99%a8>#</a>
2.1 实现计数器</h3><blockquote><p>需求：不和任何框架绑定，不使用任何构建工具，使用纯Redux实现计数器</p></blockquote><p><img src=/p/react-basic/assets/2.png width=1280 height=576 srcset="/p/react-basic/assets/2_hu68cb29d03e186d71d3f47194654e785a_2954550_480x0_resize_box_3.png 480w, /p/react-basic/assets/2_hu68cb29d03e186d71d3f47194654e785a_2954550_1024x0_resize_box_3.png 1024w" loading=lazy alt=image.png class=gallery-image data-flex-grow=222 data-flex-basis=533px>
使用步骤：</p><ol><li>定义一个 reducer 函数 （根据当前想要做的修改返回一个新的状态）</li><li>使用createStore方法传入 reducer函数 生成一个store实例对象</li><li>使用store实例的 subscribe方法 订阅数据的变化（数据一旦变化，可以得到通知）</li><li>使用store实例的 dispatch方法提交action对象 触发数据变化（告诉reducer你想怎么改数据）</li><li>使用store实例的 getState方法 获取最新的状态数据更新到视图中</li></ol><p>代码实现：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>button</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;decrement&#34;</span><span class=p>&gt;</span>-<span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>span</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;count&#34;</span><span class=p>&gt;</span>0<span class=p>&lt;/</span><span class=nt>span</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>button</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;increment&#34;</span><span class=p>&gt;</span>+<span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://unpkg.com/redux@latest/dist/redux.min.js&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 1. 定义reducer函数 
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// 作用: 根据不同的action对象，返回不同的新的state
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// state: 管理的数据初始状态
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// action: 对象 type 标记当前想要做什么样的修改
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kd>function</span> <span class=nx>reducer</span> <span class=p>(</span><span class=nx>state</span> <span class=o>=</span> <span class=p>{</span> <span class=nx>count</span><span class=o>:</span> <span class=mi>0</span> <span class=p>},</span> <span class=nx>action</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 数据不可变：基于原始状态生成一个新的状态
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=nx>action</span><span class=p>.</span><span class=nx>type</span> <span class=o>===</span> <span class=s1>&#39;INCREMENT&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=p>{</span> <span class=nx>count</span><span class=o>:</span> <span class=nx>state</span><span class=p>.</span><span class=nx>count</span> <span class=o>+</span> <span class=mi>1</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>action</span><span class=p>.</span><span class=nx>type</span> <span class=o>===</span> <span class=s1>&#39;DECREMENT&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=p>{</span> <span class=nx>count</span><span class=o>:</span> <span class=nx>state</span><span class=p>.</span><span class=nx>count</span> <span class=o>-</span> <span class=mi>1</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>state</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 2. 使用reducer函数生成store实例
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>store</span> <span class=o>=</span> <span class=nx>Redux</span><span class=p>.</span><span class=nx>createStore</span><span class=p>(</span><span class=nx>reducer</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 3. 通过store实例的subscribe订阅数据变化
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// 回调函数可以在每次state发生变化的时候自动执行
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>store</span><span class=p>.</span><span class=nx>subscribe</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;state变化了&#39;</span><span class=p>,</span> <span class=nx>store</span><span class=p>.</span><span class=nx>getState</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;count&#39;</span><span class=p>).</span><span class=nx>innerText</span> <span class=o>=</span> <span class=nx>store</span><span class=p>.</span><span class=nx>getState</span><span class=p>().</span><span class=nx>count</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 4. 通过store实例的dispatch函数提交action更改状态 
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>inBtn</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;increment&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>inBtn</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;click&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 增
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>store</span><span class=p>.</span><span class=nx>dispatch</span><span class=p>({</span>
</span></span><span class=line><span class=cl>      <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;INCREMENT&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>dBtn</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;decrement&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>dBtn</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;click&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 减
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>store</span><span class=p>.</span><span class=nx>dispatch</span><span class=p>({</span>
</span></span><span class=line><span class=cl>      <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;DECREMENT&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 5. 通过store实例的getState方法获取最新状态更新到视图中
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><h2 id=3-redux数据流架构><a href=#3-redux%e6%95%b0%e6%8d%ae%e6%b5%81%e6%9e%b6%e6%9e%84>#</a>
3. Redux数据流架构</h2><blockquote><p>Redux的难点是理解它对于数据修改的规则, 下图动态展示了在整个数据的修改中，数据的流向</p></blockquote><p><img src=/p/react-basic/assets/3.png width=1594 height=892 srcset="/p/react-basic/assets/3_hub3d7abc7542e7162e079e39ca4e7a5cc_780037_480x0_resize_box_3.png 480w, /p/react-basic/assets/3_hub3d7abc7542e7162e079e39ca4e7a5cc_780037_1024x0_resize_box_3.png 1024w" loading=lazy alt=1 class=gallery-image data-flex-grow=178 data-flex-basis=428px>
为了职责清晰，Redux代码被分为三个核心的概念，我们学redux，其实就是学这三个核心概念之间的配合，三个概念分别是:</p><ol><li>state: 一个对象 存放着我们管理的数据</li><li>action: 一个对象 用来描述你想怎么改数据</li><li>reducer: 一个函数 根据action的描述更新state</li></ol><h2 id=4-redux与react---环境准备><a href=#4-redux%e4%b8%8ereact---%e7%8e%af%e5%a2%83%e5%87%86%e5%a4%87>#</a>
4. Redux与React - 环境准备</h2><blockquote><p>Redux虽然是一个框架无关可以独立运行的插件，但是社区通常还是把它与React绑定在一起使用，以一个计数器案例体验一下Redux + React 的基础使用</p></blockquote><h3 id=41-配套工具><a href=#41-%e9%85%8d%e5%a5%97%e5%b7%a5%e5%85%b7>#</a>
4.1 配套工具</h3><blockquote><p>在React中使用redux，官方要求安装俩个其他插件 - Redux Toolkit 和 react-redux</p></blockquote><ol><li><p>Redux Toolkit（RTK）- 官方推荐编写Redux逻辑的方式，是一套工具的集合集，简化书写方式</p></li><li><p>react-redux - 用来 链接 Redux 和 React组件 的中间件</p></li></ol><p><img src=/p/react-basic/assets/4.png width=1270 height=334 srcset="/p/react-basic/assets/4_hu3423f712d0bcccfddf401aae0e7a7f66_29465_480x0_resize_box_3.png 480w, /p/react-basic/assets/4_hu3423f712d0bcccfddf401aae0e7a7f66_29465_1024x0_resize_box_3.png 1024w" loading=lazy alt=image.png class=gallery-image data-flex-grow=380 data-flex-basis=912px></p><h3 id=42-配置基础环境><a href=#42-%e9%85%8d%e7%bd%ae%e5%9f%ba%e7%a1%80%e7%8e%af%e5%a2%83>#</a>
4.2 配置基础环境</h3><ol><li>使用 CRA 快速创建 React 项目</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>npx create-react-app react-redux
</span></span></code></pre></div><ol start=2><li>安装配套工具</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>npm i @reduxjs/toolkit  react-redux
</span></span></code></pre></div><ol start=3><li>启动项目</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>npm run start
</span></span></code></pre></div><h3 id=43-store目录结构设计><a href=#43-store%e7%9b%ae%e5%bd%95%e7%bb%93%e6%9e%84%e8%ae%be%e8%ae%a1>#</a>
4.3 store目录结构设计</h3><p><img src=/p/react-basic/assets/5.png width=1280 height=521 srcset="/p/react-basic/assets/5_hu42cc591a2a6167d5613966d6fe680e6c_2672430_480x0_resize_box_3.png 480w, /p/react-basic/assets/5_hu42cc591a2a6167d5613966d6fe680e6c_2672430_1024x0_resize_box_3.png 1024w" loading=lazy alt=image.png class=gallery-image data-flex-grow=245 data-flex-basis=589px></p><ol><li><p>通常集中状态管理的部分都会单独创建一个单独的 <code>store</code> 目录</p></li><li><p>应用通常会有很多个子store模块，所以创建一个 <code>modules</code> 目录，在内部编写业务分类的子store</p></li><li><p>store中的入口文件 index.js 的作用是组合modules中所有的子模块，并导出store</p></li></ol><h2 id=5-redux与react---实现counter><a href=#5-redux%e4%b8%8ereact---%e5%ae%9e%e7%8e%b0counter>#</a>
5. Redux与React - 实现counter</h2><h3 id=51-整体路径熟悉><a href=#51-%e6%95%b4%e4%bd%93%e8%b7%af%e5%be%84%e7%86%9f%e6%82%89>#</a>
5.1 整体路径熟悉</h3><p><img src=/p/react-basic/assets/6.png width=1904 height=820 srcset="/p/react-basic/assets/6_huab3ca89321a1017439db08964a1a824e_230346_480x0_resize_box_3.png 480w, /p/react-basic/assets/6_huab3ca89321a1017439db08964a1a824e_230346_1024x0_resize_box_3.png 1024w" loading=lazy alt=image.png class=gallery-image data-flex-grow=232 data-flex-basis=557px></p><h3 id=52-使用react-toolkit-创建-counterstore><a href=#52-%e4%bd%bf%e7%94%a8react-toolkit-%e5%88%9b%e5%bb%ba-counterstore>#</a>
5.2 使用React Toolkit 创建 counterStore</h3><blockquote><p>modules/counterStore.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>createSlice</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;@reduxjs/toolkit&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>counterStore</span> <span class=o>=</span> <span class=nx>createSlice</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 模块名称独一无二
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;counter&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 初始数据
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>initialState</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>count</span><span class=o>:</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 修改数据的同步方法,支持直接修改
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>reducers</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>increment</span> <span class=p>(</span><span class=nx>state</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>state</span><span class=p>.</span><span class=nx>count</span><span class=o>++</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nx>decrement</span><span class=p>(</span><span class=nx>state</span><span class=p>){</span>
</span></span><span class=line><span class=cl>      <span class=nx>state</span><span class=p>.</span><span class=nx>count</span><span class=o>--</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=c1>// 解构出actionCreater
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=p>{</span> <span class=nx>increment</span><span class=p>,</span><span class=nx>decrement</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>counterStore</span><span class=p>.</span><span class=nx>actions</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 获取reducer函数
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>counterReducer</span> <span class=o>=</span> <span class=nx>counterStore</span><span class=p>.</span><span class=nx>reducer</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 按需导出的方式导出actionCreater
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>export</span> <span class=p>{</span> <span class=nx>increment</span><span class=p>,</span> <span class=nx>decrement</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>// 以默认导出的方式导出reducer
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>export</span> <span class=k>default</span> <span class=nx>counterReducer</span>
</span></span></code></pre></div><blockquote><p>store/index.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>configureStore</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;@reduxjs/toolkit&#39;</span>
</span></span><span class=line><span class=cl><span class=c1>// 导入子模块reducer
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=nx>counterReducer</span> <span class=nx>from</span> <span class=s1>&#39;./modules/counterStore&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>store</span> <span class=o>=</span>  <span class=nx>configureStore</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>reducer</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 注册子模块
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>counter</span><span class=o>:</span> <span class=nx>counterReducer</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>store</span>
</span></span></code></pre></div><h3 id=53-为react注入store><a href=#53-%e4%b8%bareact%e6%b3%a8%e5%85%a5store>#</a>
5.3 为React注入store</h3><blockquote><p>react-redux负责把Redux和React 链接 起来，内置 Provider组件 通过 store 参数把创建好的store实例注入到应用中，链接正式建立</p></blockquote><blockquote><p>index.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kr>import</span> <span class=nx>React</span> <span class=nx>from</span> <span class=s1>&#39;react&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>ReactDOM</span> <span class=nx>from</span> <span class=s1>&#39;react-dom/client&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>App</span> <span class=nx>from</span> <span class=s1>&#39;./App&#39;</span>
</span></span><span class=line><span class=cl><span class=c1>// 导入store
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=nx>store</span> <span class=nx>from</span> <span class=s1>&#39;./store&#39;</span>
</span></span><span class=line><span class=cl><span class=c1>// 导入store提供组件Provider
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>Provider</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;react-redux&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>ReactDOM</span><span class=p>.</span><span class=nx>createRoot</span><span class=p>(</span><span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;root&#39;</span><span class=p>)).</span><span class=nx>render</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 提供store数据
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>&lt;</span><span class=nt>Provider</span> <span class=na>store</span><span class=o>=</span><span class=p>{</span><span class=nx>store</span><span class=p>}&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>App</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>Provider</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></div><h3 id=54-react组件使用store中的数据><a href=#54-react%e7%bb%84%e4%bb%b6%e4%bd%bf%e7%94%a8store%e4%b8%ad%e7%9a%84%e6%95%b0%e6%8d%ae>#</a>
5.4 React组件使用store中的数据</h3><blockquote><p>在React组件中使用store中的数据，需要用到一个钩子函数 - useSelector，它的作用是把store中的数据映射到组件中，使用样例如下：</p></blockquote><p><img src=/p/react-basic/assets/7.png width=1088 height=764 srcset="/p/react-basic/assets/7_hu70a5417d6f366615b1bfa5ec5af59c6d_124527_480x0_resize_box_3.png 480w, /p/react-basic/assets/7_hu70a5417d6f366615b1bfa5ec5af59c6d_124527_1024x0_resize_box_3.png 1024w" loading=lazy alt=image.png class=gallery-image data-flex-grow=142 data-flex-basis=341px></p><h3 id=55-react组件修改store中的数据><a href=#55-react%e7%bb%84%e4%bb%b6%e4%bf%ae%e6%94%b9store%e4%b8%ad%e7%9a%84%e6%95%b0%e6%8d%ae>#</a>
5.5 React组件修改store中的数据</h3><blockquote><p>React组件中修改store中的数据需要借助另外一个hook函数 - useDispatch，它的作用是生成提交action对象的dispatch函数，使用样例如下：</p></blockquote><p><img src=/p/react-basic/assets/8.png width=1151 height=720 srcset="/p/react-basic/assets/8_hu7ee6b6290f2616d699236bc48526b50e_2490975_480x0_resize_box_3.png 480w, /p/react-basic/assets/8_hu7ee6b6290f2616d699236bc48526b50e_2490975_1024x0_resize_box_3.png 1024w" loading=lazy alt=image.png class=gallery-image data-flex-grow=159 data-flex-basis=383px></p><h2 id=6-redux与react---提交action传参><a href=#6-redux%e4%b8%8ereact---%e6%8f%90%e4%ba%a4action%e4%bc%a0%e5%8f%82>#</a>
6. Redux与React - 提交action传参</h2><blockquote><p>需求：组件中有俩个按钮 <code>add to 10</code> 和 <code>add to 20</code> 可以直接把count值修改到对应的数字，目标count值是在组件中传递过去的，需要在提交action的时候传递参数</p></blockquote><p><img src=/p/react-basic/assets/9.png width=1280 height=328 srcset="/p/react-basic/assets/9_hu9cb06c833018e0c119d79ccbef83face_1682487_480x0_resize_box_3.png 480w, /p/react-basic/assets/9_hu9cb06c833018e0c119d79ccbef83face_1682487_1024x0_resize_box_3.png 1024w" loading=lazy alt=image.png class=gallery-image data-flex-grow=390 data-flex-basis=936px>
实现方式：在reducers的同步修改方法中添加action对象参数，在调用actionCreater的时候传递参数，参数会被传递到action对象payload属性上</p><p><img src=/p/react-basic/assets/10.png width=1280 height=482 srcset="/p/react-basic/assets/10_hu97d1c63815ca481b964b9e1f98349ed2_2472393_480x0_resize_box_3.png 480w, /p/react-basic/assets/10_hu97d1c63815ca481b964b9e1f98349ed2_2472393_1024x0_resize_box_3.png 1024w" loading=lazy alt=image.png class=gallery-image data-flex-grow=265 data-flex-basis=637px></p><h2 id=7-redux与react---异步action处理><a href=#7-redux%e4%b8%8ereact---%e5%bc%82%e6%ad%a5action%e5%a4%84%e7%90%86>#</a>
7. Redux与React - 异步action处理</h2><p><strong>需求理解</strong>
<img src=/p/react-basic/assets/11.png width=1910 height=772 srcset="/p/react-basic/assets/11_hu6ea0656e03fe7d313cc2ddfc8f009981_348566_480x0_resize_box_3.png 480w, /p/react-basic/assets/11_hu6ea0656e03fe7d313cc2ddfc8f009981_348566_1024x0_resize_box_3.png 1024w" loading=lazy alt=image.png class=gallery-image data-flex-grow=247 data-flex-basis=593px></p><p><strong>实现步骤</strong></p><ol><li>创建store的写法保持不变，配置好同步修改状态的方法</li><li>单独封装一个函数，在函数内部return一个新函数，在新函数中
2.1 封装异步请求获取数据
2.2 调用同步actionCreater传入异步数据生成一个action对象，并使用dispatch提交</li><li>组件中dispatch的写法保持不变</li></ol><p><strong>代码实现</strong></p><blockquote><p>测试接口地址： <a class=link href=http://geek.itheima.net/v1_0/channels%27 target=_blank rel=noopener>http://geek.itheima.net/v1_0/channels</a></p><p>channelStore.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>createSlice</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;@reduxjs/toolkit&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>axios</span> <span class=nx>from</span> <span class=s1>&#39;axios&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>channelStore</span> <span class=o>=</span> <span class=nx>createSlice</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;channel&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>initialState</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>channelList</span><span class=o>:</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nx>reducers</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>setChannelList</span> <span class=p>(</span><span class=nx>state</span><span class=p>,</span> <span class=nx>action</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>state</span><span class=p>.</span><span class=nx>channelList</span> <span class=o>=</span> <span class=nx>action</span><span class=p>.</span><span class=nx>payload</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 创建异步
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=p>{</span> <span class=nx>setChannelList</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>channelStore</span><span class=p>.</span><span class=nx>actions</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>url</span> <span class=o>=</span> <span class=s1>&#39;http://geek.itheima.net/v1_0/channels&#39;</span>
</span></span><span class=line><span class=cl><span class=c1>// 封装一个函数 在函数中return一个新函数 在新函数中封装异步
</span></span></span><span class=line><span class=cl><span class=c1>// 得到数据之后通过dispatch函数 触发修改
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>fetchChannelList</span> <span class=o>=</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=kr>async</span> <span class=p>(</span><span class=nx>dispatch</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>res</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>axios</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=nx>url</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>dispatch</span><span class=p>(</span><span class=nx>setChannelList</span><span class=p>(</span><span class=nx>res</span><span class=p>.</span><span class=nx>data</span><span class=p>.</span><span class=nx>data</span><span class=p>.</span><span class=nx>channels</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=p>{</span> <span class=nx>fetchChannelList</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>channelReducer</span> <span class=o>=</span> <span class=nx>channelStore</span><span class=p>.</span><span class=nx>reducer</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>channelReducer</span>
</span></span></code></pre></div><blockquote><p>store/index.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>configureStore</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;@reduxjs/toolkit&#39;</span>
</span></span><span class=line><span class=cl><span class=c1>// 导入子模块reducer
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=nx>counterReducer</span> <span class=nx>from</span> <span class=s1>&#39;./modules/counterStore&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>channelReducer</span> <span class=nx>from</span> <span class=s1>&#39;./modules/channelStore&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>store</span> <span class=o>=</span>  <span class=nx>configureStore</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>reducer</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 注册子模块
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>counter</span><span class=o>:</span> <span class=nx>counterReducer</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>channel</span><span class=o>:</span> <span class=nx>channelReducer</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>store</span>
</span></span></code></pre></div><blockquote><p>App.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>useEffect</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;react&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>useSelector</span><span class=p>,</span> <span class=nx>useDispatch</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;react-redux&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>fetchChannelList</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;./store/channelStore&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 使用数据
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=p>{</span> <span class=nx>channelList</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>useSelector</span><span class=p>(</span><span class=nx>state</span> <span class=p>=&gt;</span> <span class=nx>state</span><span class=p>.</span><span class=nx>channel</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>useEffect</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>dispatch</span><span class=p>(</span><span class=nx>fetchChannelList</span><span class=p>())</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span> <span class=p>[</span><span class=nx>dispatch</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>className</span><span class=o>=</span><span class=s>&#34;App&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>ul</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=nx>channelList</span><span class=p>.</span><span class=nx>map</span><span class=p>(</span><span class=nx>task</span> <span class=p>=&gt;</span> <span class=p>&lt;</span><span class=nt>li</span> <span class=na>key</span><span class=o>=</span><span class=p>{</span><span class=nx>task</span><span class=p>.</span><span class=nx>id</span><span class=p>}&gt;{</span><span class=nx>task</span><span class=p>.</span><span class=nx>name</span><span class=p>}&lt;/</span><span class=nt>li</span><span class=p>&gt;)}</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;/</span><span class=nt>ul</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span>
</span></span></code></pre></div><h2 id=8-redux调试---devtools><a href=#8-redux%e8%b0%83%e8%af%95---devtools>#</a>
8. Redux调试 - devtools</h2><blockquote><p>Redux官方提供了针对于Redux的调试工具，支持实时state信息展示，action提交信息查看等</p></blockquote><p><img src=/p/react-basic/assets/12.png width=1280 height=408 srcset="/p/react-basic/assets/12_hub0a9df3a5fb94f3b5610801c2fbc06fb_2092827_480x0_resize_box_3.png 480w, /p/react-basic/assets/12_hub0a9df3a5fb94f3b5610801c2fbc06fb_2092827_1024x0_resize_box_3.png 1024w" loading=lazy alt=image.png class=gallery-image data-flex-grow=313 data-flex-basis=752px></p><h1 id=四reactrouter><a href=#%e5%9b%9breactrouter>#</a>
四、ReactRouter</h1><h2 id=41-reactrouter快速体验><a href=#41-reactrouter%e5%bf%ab%e9%80%9f%e4%bd%93%e9%aa%8c>#</a>
4.1 ReactRouter快速体验</h2><h3 id=411-什么是前端路由><a href=#411-%e4%bb%80%e4%b9%88%e6%98%af%e5%89%8d%e7%ab%af%e8%b7%af%e7%94%b1>#</a>
4.1.1 什么是前端路由</h3><p>一个路径 path 对应一个组件 component 当我们在浏览器中访问一个 path 的时候，path 对应的组件会在页面中进行渲染
<img src=/p/react-basic/assets/4-1.png width=1280 height=395 srcset="/p/react-basic/assets/4-1_hu547c9d8941ef1a55907587bb934a079e_2026136_480x0_resize_box_3.png 480w, /p/react-basic/assets/4-1_hu547c9d8941ef1a55907587bb934a079e_2026136_1024x0_resize_box_3.png 1024w" loading=lazy alt=image.png class=gallery-image data-flex-grow=324 data-flex-basis=777px></p><h3 id=412-创建路由开发环境><a href=#412-%e5%88%9b%e5%bb%ba%e8%b7%af%e7%94%b1%e5%bc%80%e5%8f%91%e7%8e%af%e5%a2%83>#</a>
4.1.2 创建路由开发环境</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 使用CRA创建项目</span>
</span></span><span class=line><span class=cl>npm create-react-app react-router-pro
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 安装最新的ReactRouter包</span>
</span></span><span class=line><span class=cl>npm i react-router-dom
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 启动项目</span>
</span></span><span class=line><span class=cl>npm run start
</span></span></code></pre></div><h3 id=413-快速开始><a href=#413-%e5%bf%ab%e9%80%9f%e5%bc%80%e5%a7%8b>#</a>
4.1.3 快速开始</h3><p><img src=/p/react-basic/assets/4-2.png width=876 height=338 srcset="/p/react-basic/assets/4-2_hu93f631abe54d2988e0fc81927b5a7777_42697_480x0_resize_box_3.png 480w, /p/react-basic/assets/4-2_hu93f631abe54d2988e0fc81927b5a7777_42697_1024x0_resize_box_3.png 1024w" loading=lazy alt=image.png class=gallery-image data-flex-grow=259 data-flex-basis=622px></p><blockquote><p>index.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kr>import</span> <span class=nx>React</span> <span class=nx>from</span> <span class=s1>&#39;react&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>ReactDOM</span> <span class=nx>from</span> <span class=s1>&#39;react-dom/client&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 1.创建router实例对象并且配置路由对应关系
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>router</span> <span class=o>=</span> <span class=nx>createBrowserRouter</span><span class=p>([</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>path</span><span class=o>:</span><span class=s1>&#39;/login&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>element</span><span class=o>:</span> <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span><span class=nx>登录</span><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>path</span><span class=o>:</span><span class=s1>&#39;/article&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>element</span><span class=o>:</span> <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span><span class=nx>文章</span><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>ReactDOM</span><span class=p>.</span><span class=nx>createRoot</span><span class=p>(</span><span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;root&#39;</span><span class=p>)).</span><span class=nx>render</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=cm>/* 2.路由绑定 */</span><span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>RouterProvider</span> <span class=na>router</span><span class=o>=</span><span class=p>{</span><span class=nx>router</span><span class=p>}/&gt;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></div><h3 id=414-抽象路由模块><a href=#414-%e6%8a%bd%e8%b1%a1%e8%b7%af%e7%94%b1%e6%a8%a1%e5%9d%97>#</a>
4.1.4 抽象路由模块</h3><p><img src=/p/react-basic/assets/4-3.png width=1792 height=412 srcset="/p/react-basic/assets/4-3_hu7a34e175ae105306ee427464c2d7f2e3_48741_480x0_resize_box_3.png 480w, /p/react-basic/assets/4-3_hu7a34e175ae105306ee427464c2d7f2e3_48741_1024x0_resize_box_3.png 1024w" loading=lazy alt=image.png class=gallery-image data-flex-grow=434 data-flex-basis=1043px></p><blockquote><p>pages/Article/index.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kr>const</span> <span class=nx>Article</span> <span class=o>=</span> <span class=p>()=&gt;{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span><span class=nx>我是文章页</span><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>Article</span>
</span></span></code></pre></div><blockquote><p>pages/Login/index.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kr>const</span> <span class=nx>Login</span> <span class=o>=</span> <span class=p>()=&gt;{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span><span class=nx>我是登录页</span><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>Login</span>
</span></span></code></pre></div><blockquote><p>router/index.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kr>import</span> <span class=nx>Login</span> <span class=nx>from</span> <span class=s2>&#34;../pages/Login&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>Article</span> <span class=nx>from</span> <span class=s2>&#34;../pages/Article&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>createBrowserRouter</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;react-router-dom&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>router</span> <span class=o>=</span> <span class=nx>createBrowserRouter</span><span class=p>([</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>path</span><span class=o>:</span><span class=s1>&#39;/login&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>element</span><span class=o>:</span><span class=p>&lt;</span><span class=nt>Login</span><span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>path</span><span class=o>:</span><span class=s1>&#39;/article&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>element</span><span class=o>:</span><span class=p>&lt;</span><span class=nt>Article</span><span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]);</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>router</span>
</span></span></code></pre></div><blockquote><p>index.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kr>import</span> <span class=nx>React</span> <span class=nx>from</span> <span class=s1>&#39;react&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>ReactDOM</span> <span class=nx>from</span> <span class=s1>&#39;react-dom/client&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=s1>&#39;./index.css&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>reportWebVitals</span> <span class=nx>from</span> <span class=s1>&#39;./reportWebVitals&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>RouterProvider</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;react-router-dom&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>router</span> <span class=nx>from</span> <span class=s1>&#39;./router&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>root</span> <span class=o>=</span> <span class=nx>ReactDOM</span><span class=p>.</span><span class=nx>createRoot</span><span class=p>(</span><span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;root&#39;</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=nx>root</span><span class=p>.</span><span class=nx>render</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>React.StrictMode</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>RouterProvider</span> <span class=na>router</span><span class=o>=</span><span class=p>{</span><span class=nx>router</span><span class=p>}&gt;&lt;/</span><span class=nt>RouterProvider</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>React.StrictMode</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// If you want to start measuring performance in your app, pass a function
</span></span></span><span class=line><span class=cl><span class=c1>// to log results (for example: reportWebVitals(console.log))
</span></span></span><span class=line><span class=cl><span class=c1>// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>reportWebVitals</span><span class=p>();</span>
</span></span></code></pre></div><h2 id=42-路由导航><a href=#42-%e8%b7%af%e7%94%b1%e5%af%bc%e8%88%aa>#</a>
4.2 路由导航</h2><h3 id=421-什么是路由导航><a href=#421-%e4%bb%80%e4%b9%88%e6%98%af%e8%b7%af%e7%94%b1%e5%af%bc%e8%88%aa>#</a>
4.2.1 什么是路由导航</h3><p>路由系统中的多个路由之间需要进行路由跳转，并且在跳转的同时有可能需要传递参数进行通信
<img src=/p/react-basic/assets/4-4.png width=1180 height=442 srcset="/p/react-basic/assets/4-4_hub419186dc62a08bbd2d0f15c9952b55b_17414_480x0_resize_box_3.png 480w, /p/react-basic/assets/4-4_hub419186dc62a08bbd2d0f15c9952b55b_17414_1024x0_resize_box_3.png 1024w" loading=lazy alt=image.png class=gallery-image data-flex-grow=266 data-flex-basis=640px></p><h3 id=422-声明式导航><a href=#422-%e5%a3%b0%e6%98%8e%e5%bc%8f%e5%af%bc%e8%88%aa>#</a>
4.2.2 声明式导航</h3><blockquote><p>声明式导航是指通过在模版中通过 <code>&lt;Link/> </code>组件描述出要跳转到哪里去，比如后台管理系统的左侧菜单通常使用这种方式进行</p></blockquote><p><img src=/p/react-basic/assets/4-5.png width=1280 height=324 srcset="/p/react-basic/assets/4-5_hu46110f783307b3662fb86a53ddbce06d_1246565_480x0_resize_box_3.png 480w, /p/react-basic/assets/4-5_hu46110f783307b3662fb86a53ddbce06d_1246565_1024x0_resize_box_3.png 1024w" loading=lazy alt=image.png class=gallery-image data-flex-grow=395 data-flex-basis=948px></p><p>语法说明：通过给组件的to属性指定要跳转到路由path，组件会被渲染为浏览器支持的a链接，如果需要传参直接通过字符串拼接的方式拼接参数即可</p><h3 id=423-编程式导航><a href=#423-%e7%bc%96%e7%a8%8b%e5%bc%8f%e5%af%bc%e8%88%aa>#</a>
4.2.3 编程式导航</h3><p>编程式导航是指通过 <code>useNavigate</code> 钩子得到导航方法，然后通过调用方法以命令式的形式进行路由跳转，比如想在登录请求完毕之后跳转就可以选择这种方式，更加灵活</p><p><img src=/p/react-basic/assets/4-6.png width=1280 height=577 srcset="/p/react-basic/assets/4-6_hu51ac691792c8ba6477c6977cb903038a_2219916_480x0_resize_box_3.png 480w, /p/react-basic/assets/4-6_hu51ac691792c8ba6477c6977cb903038a_2219916_1024x0_resize_box_3.png 1024w" loading=lazy alt=image.png class=gallery-image data-flex-grow=221 data-flex-basis=532px></p><p>语法说明：通过调用navigate方法传入地址path实现跳转</p><h2 id=42-导航传参><a href=#42-%e5%af%bc%e8%88%aa%e4%bc%a0%e5%8f%82>#</a>
4.2. 导航传参</h2><p><img src=/p/react-basic/assets/4-7.png width=1726 height=842 srcset="/p/react-basic/assets/4-7_hu726b16b2b1954b02bb17a2265b87bdd1_117485_480x0_resize_box_3.png 480w, /p/react-basic/assets/4-7_hu726b16b2b1954b02bb17a2265b87bdd1_117485_1024x0_resize_box_3.png 1024w" loading=lazy alt=image.png class=gallery-image data-flex-grow=204 data-flex-basis=491px></p><p><code>注：params传参要在router/index.js文件path属性里面添加/article/:id/:name。</code></p><h2 id=43-嵌套路由配置><a href=#43-%e5%b5%8c%e5%a5%97%e8%b7%af%e7%94%b1%e9%85%8d%e7%bd%ae>#</a>
4.3 嵌套路由配置</h2><h3 id=431-什么是嵌套路由><a href=#431-%e4%bb%80%e4%b9%88%e6%98%af%e5%b5%8c%e5%a5%97%e8%b7%af%e7%94%b1>#</a>
4.3.1 什么是嵌套路由</h3><p>在一级路由中又内嵌了其他路由，这种关系就叫做嵌套路由，嵌套至一级路由内的路由又称作二级路由，例如：
<img src=/p/react-basic/assets/4-8.png width=1582 height=1040 srcset="/p/react-basic/assets/4-8_hu068277fd14c4a2898c4ce127c5a7ab3b_2050963_480x0_resize_box_3.png 480w, /p/react-basic/assets/4-8_hu068277fd14c4a2898c4ce127c5a7ab3b_2050963_1024x0_resize_box_3.png 1024w" loading=lazy alt=image.png class=gallery-image data-flex-grow=152 data-flex-basis=365px></p><h3 id=432-嵌套路由配置><a href=#432-%e5%b5%8c%e5%a5%97%e8%b7%af%e7%94%b1%e9%85%8d%e7%bd%ae>#</a>
4.3.2 嵌套路由配置</h3><blockquote><p>实现步骤</p><pre><code>1. 使用 `children`属性配置路由嵌套关系  
2. 使用 `&lt;Outlet/&gt;` 组件配置二级路由渲染位置
</code></pre></blockquote><p><img src=/p/react-basic/assets/4-9.png width=1510 height=624 srcset="/p/react-basic/assets/4-9_hu8cef1cc181b40ee9985ee76960af81b0_138251_480x0_resize_box_3.png 480w, /p/react-basic/assets/4-9_hu8cef1cc181b40ee9985ee76960af81b0_138251_1024x0_resize_box_3.png 1024w" loading=lazy alt=image.png class=gallery-image data-flex-grow=241 data-flex-basis=580px></p><h3 id=433-默认二级路由><a href=#433-%e9%bb%98%e8%ae%a4%e4%ba%8c%e7%ba%a7%e8%b7%af%e7%94%b1>#</a>
4.3.3 默认二级路由</h3><p>当访问的是一级路由时，默认的二级路由组件可以得到渲染，只需要在二级路由的位置去掉path，设置index属性为true</p><p><img src=/p/react-basic/assets/4-10.png width=1672 height=666 srcset="/p/react-basic/assets/4-10_hu1340b0ca321ef169f17ac6ccfcaec0b6_157274_480x0_resize_box_3.png 480w, /p/react-basic/assets/4-10_hu1340b0ca321ef169f17ac6ccfcaec0b6_157274_1024x0_resize_box_3.png 1024w" loading=lazy alt=image.png class=gallery-image data-flex-grow=251 data-flex-basis=602px></p><p><code>注：设置默认路由后，获取参数/?id=100，子组件和父组件都可以接受到参数值</code></p><h3 id=434-404路由配置><a href=#434-404%e8%b7%af%e7%94%b1%e9%85%8d%e7%bd%ae>#</a>
4.3.4 404路由配置</h3><p>场景：当浏览器输入url的路径在整个路由配置中都找不到对应的 path，为了用户体验，可以使用 404 兜底组件进行渲染</p><p>实现步骤：</p><ol><li>准备一个NotFound组件</li><li>在路由表数组的末尾，以*号作为路由path配置路由</li></ol><p><img src=/p/react-basic/assets/4-11.png width=1580 height=422 srcset="/p/react-basic/assets/4-11_hu22825a84c06b6ecf319b7efb5a379df8_81288_480x0_resize_box_3.png 480w, /p/react-basic/assets/4-11_hu22825a84c06b6ecf319b7efb5a379df8_81288_1024x0_resize_box_3.png 1024w" loading=lazy alt=image.png class=gallery-image data-flex-grow=374 data-flex-basis=898px></p><h3 id=435-俩种路由模式><a href=#435-%e4%bf%a9%e7%a7%8d%e8%b7%af%e7%94%b1%e6%a8%a1%e5%bc%8f>#</a>
4.3.5 俩种路由模式</h3><p>各个主流框架的路由常用的路由模式有俩种，history模式和hash模式, ReactRouter分别由 createBrowerRouter 和 createHashRouter 函数负责创建</p><div class=table-wrapper><table><thead><tr><th>路由模式</th><th>url表现</th><th>底层原理</th><th>是否需要后端支持(nginx转发)</th></tr></thead><tbody><tr><td>history</td><td>url/login</td><td>history对象 + pushState事件</td><td>需要</td></tr><tr><td>hash</td><td>url/#/login</td><td>监听hashChange事件</td><td>不需要</td></tr></tbody></table></div><h1 id=五常用hook函数><a href=#%e4%ba%94%e5%b8%b8%e7%94%a8hook%e5%87%bd%e6%95%b0>#</a>
五、常用Hook函数</h1><h2 id=51-usereducer><a href=#51-usereducer>#</a>
5.1 useReducer</h2><blockquote><p>作用：和useState的作用类似，用来管理相对复杂的状态数据</p></blockquote><h3 id=511-基础用法><a href=#511-%e5%9f%ba%e7%a1%80%e7%94%a8%e6%b3%95>#</a>
5.1.1 基础用法</h3><ol><li>定义一个reducer函数（根据不同的action返回不同的新状态）</li><li>在组件中调用useReducer，并传入reducer函数和状态的初始值</li><li>事件发生时，通过dispatch函数分派一个action对象（通知reducer要返回哪个新状态并渲染UI）</li></ol><blockquote><p>App.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>useReducer</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;react&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 1. 定义reducer函数，根据不同的action返回不同的新状态
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>reducer</span><span class=p>(</span><span class=nx>state</span><span class=p>,</span> <span class=nx>action</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>switch</span> <span class=p>(</span><span class=nx>action</span><span class=p>.</span><span class=nx>type</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=s1>&#39;INC&#39;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nx>state</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=s1>&#39;DEC&#39;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nx>state</span> <span class=o>-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=k>default</span><span class=o>:</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nx>state</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 2. 使用useReducer分派action
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=p>[</span><span class=nx>state</span><span class=p>,</span> <span class=nx>dispatch</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useReducer</span><span class=p>(</span><span class=nx>reducer</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=cm>/* 3. 调用dispatch函数传入action对象 触发reducer函数，分派action操作，使用新状态更新视图 */</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>button</span> <span class=na>onClick</span><span class=o>=</span><span class=p>{()</span> <span class=p>=&gt;</span> <span class=nx>dispatch</span><span class=p>({</span> <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;DEC&#39;</span> <span class=p>})}&gt;</span><span class=o>-</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=nx>state</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>button</span> <span class=na>onClick</span><span class=o>=</span><span class=p>{()</span> <span class=p>=&gt;</span> <span class=nx>dispatch</span><span class=p>({</span> <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;INC&#39;</span> <span class=p>})}&gt;</span><span class=o>+</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span>
</span></span></code></pre></div><h3 id=512-修改state值-分派action传参><a href=#512-%e4%bf%ae%e6%94%b9state%e5%80%bc-%e5%88%86%e6%b4%beaction%e4%bc%a0%e5%8f%82>#</a>
5.1.2 修改state值-分派action传参</h3><p>做法：分派action时如果想要传递参数，需要在action对象中添加一个payload参数，放置状态参数</p><blockquote><p>App.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=c1>// 定义reducer
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>useReducer</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;react&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 1. 根据不同的action返回不同的新状态
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>reducer</span><span class=p>(</span><span class=nx>state</span><span class=p>,</span> <span class=nx>action</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;reducer执行了&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>switch</span> <span class=p>(</span><span class=nx>action</span><span class=p>.</span><span class=nx>type</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=s1>&#39;INC&#39;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nx>state</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=s1>&#39;DEC&#39;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nx>state</span> <span class=o>-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=s1>&#39;UPDATE&#39;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nx>state</span> <span class=o>+</span> <span class=nx>action</span><span class=p>.</span><span class=nx>payload</span>
</span></span><span class=line><span class=cl>    <span class=k>default</span><span class=o>:</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nx>state</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 2. 使用useReducer分派action
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=p>[</span><span class=nx>state</span><span class=p>,</span> <span class=nx>dispatch</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useReducer</span><span class=p>(</span><span class=nx>reducer</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=cm>/* 3. 调用dispatch函数传入action对象 触发reducer函数，分派action操作，使用新状态更新视图 */</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>button</span> <span class=na>onClick</span><span class=o>=</span><span class=p>{()</span> <span class=p>=&gt;</span> <span class=nx>dispatch</span><span class=p>({</span> <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;DEC&#39;</span> <span class=p>})}&gt;</span><span class=o>-</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=nx>state</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>button</span> <span class=na>onClick</span><span class=o>=</span><span class=p>{()</span> <span class=p>=&gt;</span> <span class=nx>dispatch</span><span class=p>({</span> <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;INC&#39;</span> <span class=p>})}&gt;</span><span class=o>+</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>button</span> <span class=na>onClick</span><span class=o>=</span><span class=p>{()</span> <span class=p>=&gt;</span> <span class=nx>dispatch</span><span class=p>({</span> <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;UPDATE&#39;</span><span class=p>,</span> <span class=nx>payload</span><span class=o>:</span> <span class=mi>100</span> <span class=p>})}&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nx>update</span> <span class=nx>to</span> <span class=mi>100</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span>
</span></span></code></pre></div><h3 id=513-更新流程><a href=#513-%e6%9b%b4%e6%96%b0%e6%b5%81%e7%a8%8b>#</a>
5.1.3 更新流程</h3><p><img src=/p/react-basic/assets/10-1.png width=1816 height=1022 srcset="/p/react-basic/assets/10-1_hu36aee24ff10a8664864394103d44cd2f_340244_480x0_resize_box_3.png 480w, /p/react-basic/assets/10-1_hu36aee24ff10a8664864394103d44cd2f_340244_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=177 data-flex-basis=426px></p><h2 id=52-usememo><a href=#52-usememo>#</a>
5.2 useMemo</h2><p>作用：它在每次重新渲染的时候能够缓存计算的结果</p><h3 id=521-示例><a href=#521-%e7%a4%ba%e4%be%8b>#</a>
5.2.1 示例</h3><p>下面我们的本来的用意是想<strong>基于count的变化计算斐波那契数列之和</strong>，但是当我们修改num状态的时候，斐波那契求和函数也会被执行，显然是一种浪费</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=c1>// useMemo
</span></span></span><span class=line><span class=cl><span class=c1>// 作用：在组件渲染时缓存计算的结果
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>useState</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;react&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>factorialOf</span><span class=p>(</span><span class=nx>n</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;斐波那契函数执行了&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>n</span> <span class=o>&lt;=</span> <span class=mi>0</span> <span class=o>?</span> <span class=mi>1</span> <span class=o>:</span> <span class=nx>n</span> <span class=o>*</span> <span class=nx>factorialOf</span><span class=p>(</span><span class=nx>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>[</span><span class=nx>count</span><span class=p>,</span> <span class=nx>setCount</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 计算斐波那契之和
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>sumByCount</span> <span class=o>=</span> <span class=nx>factorialOf</span><span class=p>(</span><span class=nx>count</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>[</span><span class=nx>num</span><span class=p>,</span> <span class=nx>setNum</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=nx>sum</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>button</span> <span class=na>onClick</span><span class=o>=</span><span class=p>{()</span> <span class=p>=&gt;</span> <span class=nx>setCount</span><span class=p>(</span><span class=nx>count</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)}&gt;</span><span class=o>+</span><span class=nx>count</span><span class=o>:</span><span class=p>{</span><span class=nx>count</span><span class=p>}&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>button</span> <span class=na>onClick</span><span class=o>=</span><span class=p>{()</span> <span class=p>=&gt;</span> <span class=nx>setNum</span><span class=p>(</span><span class=nx>num</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)}&gt;</span><span class=o>+</span><span class=nx>num</span><span class=o>:</span><span class=p>{</span><span class=nx>num</span><span class=p>}&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span>
</span></span></code></pre></div><blockquote><p>优化：useMemo缓存计算结果，只有count发生变化时才重新进行计算</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>useMemo</span><span class=p>,</span> <span class=nx>useState</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;react&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>fib</span> <span class=p>(</span><span class=nx>n</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;计算函数执行了&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>n</span> <span class=o>&lt;</span> <span class=mi>3</span><span class=p>)</span> <span class=k>return</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>fib</span><span class=p>(</span><span class=nx>n</span> <span class=o>-</span> <span class=mi>2</span><span class=p>)</span> <span class=o>+</span> <span class=nx>fib</span><span class=p>(</span><span class=nx>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>[</span><span class=nx>count</span><span class=p>,</span> <span class=nx>setCount</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 计算斐波那契之和
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// const sum = fib(count)
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// 通过useMemo缓存计算结果，只有count发生变化时才重新计算
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>sum</span> <span class=o>=</span> <span class=nx>useMemo</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>fib</span><span class=p>(</span><span class=nx>count</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span> <span class=p>[</span><span class=nx>count</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>[</span><span class=nx>num</span><span class=p>,</span> <span class=nx>setNum</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=nx>sum</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>button</span> <span class=na>onClick</span><span class=o>=</span><span class=p>{()</span> <span class=p>=&gt;</span> <span class=nx>setCount</span><span class=p>(</span><span class=nx>count</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)}&gt;</span><span class=o>+</span><span class=nx>count</span><span class=o>:</span><span class=p>{</span><span class=nx>count</span><span class=p>}&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>button</span> <span class=na>onClick</span><span class=o>=</span><span class=p>{()</span> <span class=p>=&gt;</span> <span class=nx>setNum</span><span class=p>(</span><span class=nx>num</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)}&gt;</span><span class=o>+</span><span class=nx>num</span><span class=o>:</span><span class=p>{</span><span class=nx>num</span><span class=p>}&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span>
</span></span></code></pre></div><h2 id=53-reactmemo><a href=#53-reactmemo>#</a>
5.3 React.memo</h2><p>作用：允许组件在props没有改变的情况下跳过重新渲染</p><h3 id=531-组件默认的渲染机制><a href=#531-%e7%bb%84%e4%bb%b6%e9%bb%98%e8%ae%a4%e7%9a%84%e6%b8%b2%e6%9f%93%e6%9c%ba%e5%88%b6>#</a>
5.3.1 组件默认的渲染机制</h3><blockquote><p>默认机制：顶层组件发生重新渲染，这个组件树的子级组件都会被重新渲染</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=c1>// memo
</span></span></span><span class=line><span class=cl><span class=c1>// 作用：允许组件在props没有改变的情况下跳过重新渲染
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>useState</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;react&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>Son</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;子组件被重新渲染了&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span><span class=k>this</span> <span class=nx>is</span> <span class=nx>son</span><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>[,</span> <span class=nx>forceUpdate</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;父组件重新渲染了&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>Son</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>button</span> <span class=na>onClick</span><span class=o>=</span><span class=p>{()</span> <span class=p>=&gt;</span> <span class=nx>forceUpdate</span><span class=p>(</span><span class=nb>Math</span><span class=p>.</span><span class=nx>random</span><span class=p>())}&gt;</span><span class=nx>update</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span>
</span></span></code></pre></div><h3 id=532-使用reactmemo优化><a href=#532-%e4%bd%bf%e7%94%a8reactmemo%e4%bc%98%e5%8c%96>#</a>
5.3.2 使用React.memo优化</h3><blockquote><p>机制：只有props发生变化时才重新渲染
下面的子组件通过 memo 进行包裹之后，返回一个新的组件MemoSon, 只有传给MemoSon的props参数发生变化时才会重新渲染</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kr>import</span> <span class=nx>React</span><span class=p>,</span> <span class=p>{</span> <span class=nx>useState</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;react&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>MemoSon</span> <span class=o>=</span> <span class=nx>React</span><span class=p>.</span><span class=nx>memo</span><span class=p>(</span><span class=kd>function</span> <span class=nx>Son</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;子组件被重新渲染了&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span><span class=k>this</span> <span class=nx>is</span> <span class=nx>span</span><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>[,</span> <span class=nx>forceUpdate</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;父组件重新渲染了&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>MemoSon</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>button</span> <span class=na>onClick</span><span class=o>=</span><span class=p>{()</span> <span class=p>=&gt;</span> <span class=nx>forceUpdate</span><span class=p>(</span><span class=nb>Math</span><span class=p>.</span><span class=nx>random</span><span class=p>())}&gt;</span><span class=nx>update</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span>
</span></span></code></pre></div><blockquote><p>props变化重新渲染</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kr>import</span> <span class=nx>React</span><span class=p>,</span> <span class=p>{</span> <span class=nx>useState</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;react&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>MemoSon</span> <span class=o>=</span> <span class=nx>React</span><span class=p>.</span><span class=nx>memo</span><span class=p>(</span><span class=kd>function</span> <span class=nx>Son</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;子组件被重新渲染了&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span><span class=k>this</span> <span class=nx>is</span> <span class=nx>span</span><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;父组件重新渲染了&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>[</span><span class=nx>count</span><span class=p>,</span> <span class=nx>setCount</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>MemoSon</span> <span class=na>count</span><span class=o>=</span><span class=p>{</span><span class=nx>count</span><span class=p>}</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>button</span> <span class=na>onClick</span><span class=o>=</span><span class=p>{()</span> <span class=p>=&gt;</span> <span class=nx>setCount</span><span class=p>(</span><span class=nx>count</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)}&gt;</span><span class=o>+</span><span class=p>{</span><span class=nx>count</span><span class=p>}&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span>
</span></span></code></pre></div><h3 id=533-props的比较机制><a href=#533-props%e7%9a%84%e6%af%94%e8%be%83%e6%9c%ba%e5%88%b6>#</a>
5.3.3 props的比较机制</h3><blockquote><p>对于props的比较，进行的是‘浅比较’，底层使用 <code>Object.is</code> 进行比较，针对于对象数据类型，只会对比俩次的引用是否相等，如果不相等就会重新渲染，React并不关心对象中的具体属性</p></blockquote><p>示例：</p><ol><li><p>prop是简单类型</p><p>Object.is(3,3)=>true 没有变化</p></li><li><p>prop是引用类型（对象/数组）</p><p>Object.is([],[])=>false 有变化，React只关心引用是否变化</p></li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=c1>// React.memo props比较机制
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// 1. 传递一个简单类型的prop  prop变化时组件重新渲染
</span></span></span><span class=line><span class=cl><span class=c1>// 2. 传递一个引用类型的prop  比较的是新值和旧值的引用是否相等  当父组件的函数重新执行时，实际上形成的是新的数组引用
</span></span></span><span class=line><span class=cl><span class=c1>// 3. 保证引用稳定 -》 useMemo 组件渲染过程中缓存一个值
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>useMemo</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;react&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>useState</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;react&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>memo</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;react&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>MemoSon</span><span class=o>=</span> <span class=nx>memo</span><span class=p>(</span><span class=kd>function</span> <span class=nx>Son</span><span class=p>({</span><span class=nx>list</span><span class=p>}){</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;子组件重新渲染&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span><span class=k>this</span> <span class=nx>is</span> <span class=nx>Son</span><span class=p>{</span><span class=nx>list</span><span class=p>}&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>[</span><span class=nx>count</span><span class=p>,</span><span class=nx>setCount</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>list</span> <span class=o>=</span> <span class=nx>useMemo</span><span class=p>(()=&gt;{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=p>},[])</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>className</span><span class=o>=</span><span class=s>&#34;App&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>MemoSon</span> <span class=na>list</span><span class=o>=</span><span class=p>{</span><span class=nx>list</span><span class=p>}/&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>button</span> <span class=na>onClick</span><span class=o>=</span><span class=p>{()=&gt;{</span><span class=nx>setCount</span><span class=p>(</span><span class=nx>count</span><span class=o>+</span><span class=mi>1</span><span class=p>)}}&gt;</span><span class=nx>change</span> <span class=nx>count</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span><span class=p>;</span>
</span></span></code></pre></div><h3 id=534-自定义比较函数><a href=#534-%e8%87%aa%e5%ae%9a%e4%b9%89%e6%af%94%e8%be%83%e5%87%bd%e6%95%b0>#</a>
5.3.4 自定义比较函数</h3><blockquote><p>如果上一小节的例子，我们不想通过引用来比较，而是完全比较数组的成员是否完全一致，则可以通过自定义比较函数来实现</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kr>import</span> <span class=nx>React</span><span class=p>,</span> <span class=p>{</span> <span class=nx>useState</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;react&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 自定义比较函数
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>arePropsEqual</span><span class=p>(</span><span class=nx>oldProps</span><span class=p>,</span> <span class=nx>newProps</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>oldProps</span><span class=p>,</span> <span class=nx>newProps</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=nx>oldProps</span><span class=p>.</span><span class=nx>list</span><span class=p>.</span><span class=nx>length</span> <span class=o>===</span> <span class=nx>newProps</span><span class=p>.</span><span class=nx>list</span><span class=p>.</span><span class=nx>length</span> <span class=o>&amp;&amp;</span>
</span></span><span class=line><span class=cl>    <span class=nx>oldProps</span><span class=p>.</span><span class=nx>list</span><span class=p>.</span><span class=nx>every</span><span class=p>((</span><span class=nx>oldItem</span><span class=p>,</span> <span class=nx>index</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>newItem</span> <span class=o>=</span> <span class=nx>newProps</span><span class=p>.</span><span class=nx>list</span><span class=p>[</span><span class=nx>index</span><span class=p>]</span>
</span></span><span class=line><span class=cl>      <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>newItem</span><span class=p>,</span> <span class=nx>oldItem</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nx>oldItem</span> <span class=o>===</span> <span class=nx>newItem</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>MemoSon</span> <span class=o>=</span> <span class=nx>React</span><span class=p>.</span><span class=nx>memo</span><span class=p>(</span><span class=kd>function</span> <span class=nx>Son</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;子组件被重新渲染了&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span><span class=k>this</span> <span class=nx>is</span> <span class=nx>span</span><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>},</span> <span class=nx>arePropsEqual</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;父组件重新渲染了&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>[</span><span class=nx>list</span><span class=p>,</span> <span class=nx>setList</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>])</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>MemoSon</span> <span class=na>list</span><span class=o>=</span><span class=p>{</span><span class=nx>list</span><span class=p>}</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>button</span> <span class=na>onClick</span><span class=o>=</span><span class=p>{()</span> <span class=p>=&gt;</span> <span class=nx>setList</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>])}&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nx>内容一样</span><span class=p>{</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>list</span><span class=p>)}</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>button</span> <span class=na>onClick</span><span class=o>=</span><span class=p>{()</span> <span class=p>=&gt;</span> <span class=nx>setList</span><span class=p>([</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>])}&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nx>内容不一样</span><span class=p>{</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>list</span><span class=p>)}</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span>
</span></span></code></pre></div><h2 id=54-usecallback><a href=#54-usecallback>#</a>
5.4 useCallback</h2><p>作用：在组件多次重新渲染的时候<code>缓存函数</code></p><blockquote><p>useCallback缓存之后的函数可以在组件渲染时保持引用稳定，也就是返回同一个引用</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=c1>// useCallBack
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>memo</span><span class=p>,</span> <span class=nx>useCallback</span><span class=p>,</span> <span class=nx>useState</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;react&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>MemoSon</span> <span class=o>=</span> <span class=nx>memo</span><span class=p>(</span><span class=kd>function</span> <span class=nx>Son</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Son组件渲染了&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span><span class=k>this</span> <span class=nx>is</span> <span class=nx>son</span><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>[,</span> <span class=nx>forceUpate</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;父组件重新渲染了&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>onGetSonMessage</span> <span class=o>=</span> <span class=nx>useCallback</span><span class=p>((</span><span class=nx>message</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>message</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span> <span class=p>[])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>MemoSon</span> <span class=na>onGetSonMessage</span><span class=o>=</span><span class=p>{</span><span class=nx>onGetSonMessage</span><span class=p>}</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>button</span> <span class=na>onClick</span><span class=o>=</span><span class=p>{()</span> <span class=p>=&gt;</span> <span class=nx>forceUpate</span><span class=p>(</span><span class=nb>Math</span><span class=p>.</span><span class=nx>random</span><span class=p>())}&gt;</span><span class=nx>update</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span>
</span></span></code></pre></div><h2 id=55-forwardref><a href=#55-forwardref>#</a>
5.5 forwardRef</h2><p>作用：允许组件使用ref将一个DOM节点暴露给父组件</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>forwardRef</span><span class=p>,</span> <span class=nx>useRef</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;react&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>MyInput</span> <span class=o>=</span> <span class=nx>forwardRef</span><span class=p>(</span><span class=kd>function</span> <span class=nx>Input</span><span class=p>(</span><span class=nx>props</span><span class=p>,</span> <span class=nx>ref</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>&lt;</span><span class=nt>input</span> <span class=p>{</span><span class=na>...props</span><span class=p>}</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text&#34;</span> <span class=na>ref</span><span class=o>=</span><span class=p>{</span><span class=nx>ref</span><span class=p>}</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl><span class=p>},</span> <span class=p>[])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>ref</span> <span class=o>=</span> <span class=nx>useRef</span><span class=p>(</span><span class=kc>null</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>focusHandle</span> <span class=o>=</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>ref</span><span class=p>.</span><span class=nx>current</span><span class=p>.</span><span class=nx>focus</span><span class=p>())</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>MyInput</span> <span class=na>ref</span><span class=o>=</span><span class=p>{</span><span class=nx>ref</span><span class=p>}</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>button</span> <span class=na>onClick</span><span class=o>=</span><span class=p>{</span><span class=nx>focusHandle</span><span class=p>}&gt;</span><span class=nx>focus</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span>
</span></span></code></pre></div><h2 id=56-useimperativehandle><a href=#56-useimperativehandle>#</a>
5.6 useImperativeHandle</h2><p>作用：通过ref暴露子组件中的方法</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>forwardRef</span><span class=p>,</span> <span class=nx>useImperativeHandle</span><span class=p>,</span> <span class=nx>useRef</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;react&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>MyInput</span> <span class=o>=</span> <span class=nx>forwardRef</span><span class=p>(</span><span class=kd>function</span> <span class=nx>Input</span><span class=p>(</span><span class=nx>props</span><span class=p>,</span> <span class=nx>ref</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 实现内部的聚焦逻辑
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>inputRef</span> <span class=o>=</span> <span class=nx>useRef</span><span class=p>(</span><span class=kc>null</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>focus</span> <span class=o>=</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=nx>inputRef</span><span class=p>.</span><span class=nx>current</span><span class=p>.</span><span class=nx>focus</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 暴露子组件内部的聚焦方法
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>useImperativeHandle</span><span class=p>(</span><span class=nx>ref</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>focus</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>&lt;</span><span class=nt>input</span> <span class=p>{</span><span class=na>...props</span><span class=p>}</span> <span class=na>ref</span><span class=o>=</span><span class=p>{</span><span class=nx>inputRef</span><span class=p>}</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>ref</span> <span class=o>=</span> <span class=nx>useRef</span><span class=p>(</span><span class=kc>null</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>focusHandle</span> <span class=o>=</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=nx>ref</span><span class=p>.</span><span class=nx>current</span><span class=p>.</span><span class=nx>focus</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>MyInput</span> <span class=na>ref</span><span class=o>=</span><span class=p>{</span><span class=nx>ref</span><span class=p>}</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>button</span> <span class=na>onClick</span><span class=o>=</span><span class=p>{</span><span class=nx>focusHandle</span><span class=p>}&gt;</span><span class=nx>focus</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span>
</span></span></code></pre></div><h1 id=六-zustand状态管理><a href=#%e5%85%ad-zustand%e7%8a%b6%e6%80%81%e7%ae%a1%e7%90%86>#</a>
六、 zustand状态管理</h1><h2 id=61-快速上手><a href=#61-%e5%bf%ab%e9%80%9f%e4%b8%8a%e6%89%8b>#</a>
6.1 快速上手</h2><blockquote><p>store/index.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>create</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;zustand&#39;</span>
</span></span><span class=line><span class=cl><span class=c1>// 1. 创建store
</span></span></span><span class=line><span class=cl><span class=c1>// 语法容易出错
</span></span></span><span class=line><span class=cl><span class=c1>// 1. 函数参数必须返回一个对象，对象内部编写状态数据和方法
</span></span></span><span class=line><span class=cl><span class=c1>// 2. set是用来修改数据的专门方法必须调用它来修改数据
</span></span></span><span class=line><span class=cl><span class=c1>// 语法1：参数是函数 需要在原数据基础上修改 set(state =&gt; ({ count: state.count + 1 }))
</span></span></span><span class=line><span class=cl><span class=c1>// 语法2：参数直接是一个对象  替换原数据  set({count:100})
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>useStore</span> <span class=o>=</span> <span class=nx>create</span><span class=p>((</span><span class=nx>set</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>count</span><span class=o>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>inc</span><span class=o>:</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>set</span><span class=p>(</span><span class=nx>state</span> <span class=p>=&gt;</span> <span class=p>({</span> <span class=nx>count</span><span class=o>:</span> <span class=nx>state</span><span class=p>.</span><span class=nx>count</span> <span class=o>+</span> <span class=mi>1</span> <span class=p>}))</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>useStore</span>
</span></span></code></pre></div><blockquote><p>App.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kr>import</span> <span class=nx>useStore</span> <span class=nx>from</span> <span class=s1>&#39;./store/useCounterStore.js&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>{</span> <span class=nx>count</span><span class=p>,</span> <span class=nx>inc</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>useStore</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>&lt;</span><span class=nt>button</span> <span class=na>onClick</span><span class=o>=</span><span class=p>{</span><span class=nx>inc</span><span class=p>}&gt;{</span><span class=nx>count</span><span class=p>}&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span>
</span></span></code></pre></div><h2 id=62-异步支持><a href=#62-%e5%bc%82%e6%ad%a5%e6%94%af%e6%8c%81>#</a>
6.2 异步支持</h2><p>对于异步操作的支持不需要特殊的操作，直接在函数中编写异步逻辑，最后把接口的数据放到set函数中返回即可</p><blockquote><p>store/index.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>create</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;zustand&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>URL</span> <span class=o>=</span> <span class=s1>&#39;http://geek.itheima.net/v1_0/channels&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>useStore</span> <span class=o>=</span> <span class=nx>create</span><span class=p>((</span><span class=nx>set</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>count</span><span class=o>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>ins</span><span class=o>:</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nx>set</span><span class=p>(</span><span class=nx>state</span> <span class=p>=&gt;</span> <span class=p>({</span> <span class=nx>count</span><span class=o>:</span> <span class=nx>state</span><span class=p>.</span><span class=nx>count</span> <span class=o>+</span> <span class=mi>1</span> <span class=p>}))</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nx>channelList</span><span class=o>:</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>    <span class=nx>fetchChannelList</span><span class=o>:</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>res</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>fetch</span><span class=p>(</span><span class=nx>URL</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>jsonData</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>res</span><span class=p>.</span><span class=nx>json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>      <span class=nx>set</span><span class=p>({</span><span class=nx>channelList</span><span class=o>:</span> <span class=nx>jsonData</span><span class=p>.</span><span class=nx>data</span><span class=p>.</span><span class=nx>channels</span><span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>useStore</span>
</span></span></code></pre></div><blockquote><p>App.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>useEffect</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;react&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>useChannelStore</span> <span class=nx>from</span> <span class=s1>&#39;./store/channelStore&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>{</span> <span class=nx>channelList</span><span class=p>,</span> <span class=nx>fetchChannelList</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>useChannelStore</span><span class=p>()</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>  <span class=nx>useEffect</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fetchChannelList</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span> <span class=p>[</span><span class=nx>fetchChannelList</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>ul</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=nx>channelList</span><span class=p>.</span><span class=nx>map</span><span class=p>((</span><span class=nx>item</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>li</span> <span class=na>key</span><span class=o>=</span><span class=p>{</span><span class=nx>item</span><span class=p>.</span><span class=nx>id</span><span class=p>}&gt;{</span><span class=nx>item</span><span class=p>.</span><span class=nx>name</span><span class=p>}&lt;/</span><span class=nt>li</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>))}</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>ul</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span>
</span></span></code></pre></div><h2 id=63-切片模式><a href=#63-%e5%88%87%e7%89%87%e6%a8%a1%e5%bc%8f>#</a>
6.3 切片模式</h2><p>场景：当我们单个store比较大的时候，可以采用一种<code>切片模式</code>进行模块拆分再组合</p><blockquote><p>store/index.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>create</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;zustand&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 创建counter相关切片
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>createCounterStore</span> <span class=o>=</span> <span class=p>(</span><span class=nx>set</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>count</span><span class=o>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>setCount</span><span class=o>:</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>set</span><span class=p>(</span><span class=nx>state</span> <span class=p>=&gt;</span> <span class=p>({</span> <span class=nx>count</span><span class=o>:</span> <span class=nx>state</span><span class=p>.</span><span class=nx>count</span> <span class=o>+</span> <span class=mi>1</span> <span class=p>}))</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 创建channel相关切片
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>createChannelStore</span> <span class=o>=</span> <span class=p>(</span><span class=nx>set</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>channelList</span><span class=o>:</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>    <span class=nx>fetchGetList</span><span class=o>:</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>res</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>fetch</span><span class=p>(</span><span class=nx>URL</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>jsonData</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>res</span><span class=p>.</span><span class=nx>json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>      <span class=nx>set</span><span class=p>({</span> <span class=nx>channelList</span><span class=o>:</span> <span class=nx>jsonData</span><span class=p>.</span><span class=nx>data</span><span class=p>.</span><span class=nx>channels</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 组合切片
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>useStore</span> <span class=o>=</span> <span class=nx>create</span><span class=p>((...</span><span class=nx>a</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=p>...</span><span class=nx>createCounterStore</span><span class=p>(...</span><span class=nx>a</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=p>...</span><span class=nx>createChannelStore</span><span class=p>(...</span><span class=nx>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}))</span>
</span></span></code></pre></div><blockquote><p>App.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>{</span><span class=nx>count</span><span class=p>,</span> <span class=nx>inc</span><span class=p>,</span> <span class=nx>channelList</span><span class=p>,</span> <span class=nx>fetchChannelList</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>useStore</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>button</span> <span class=na>onClick</span><span class=o>=</span><span class=p>{</span><span class=nx>inc</span><span class=p>}&gt;{</span><span class=nx>count</span><span class=p>}&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>ul</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=nx>channelList</span><span class=p>.</span><span class=nx>map</span><span class=p>((</span><span class=nx>item</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>          <span class=p>&lt;</span><span class=nt>li</span> <span class=na>key</span><span class=o>=</span><span class=p>{</span><span class=nx>item</span><span class=p>.</span><span class=nx>id</span><span class=p>}&gt;{</span><span class=nx>item</span><span class=p>.</span><span class=nx>name</span><span class=p>}&lt;/</span><span class=nt>li</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>))}</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;/</span><span class=nt>ul</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>App</span>
</span></span></code></pre></div><h1 id=九工具类><a href=#%e4%b9%9d%e5%b7%a5%e5%85%b7%e7%b1%bb>#</a>
九、工具类</h1><h3 id=1-lodash-排序工具><a href=#1-lodash-%e6%8e%92%e5%ba%8f%e5%b7%a5%e5%85%b7>#</a>
1. lodash 排序工具</h3><h3 id=2-classnames-优化类名控制><a href=#2-classnames-%e4%bc%98%e5%8c%96%e7%b1%bb%e5%90%8d%e6%8e%a7%e5%88%b6>#</a>
2. classnames 优化类名控制</h3><h3 id=3-dayjs><a href=#3-dayjs>#</a>
3. dayjs</h3></section><footer class=article-footer><section class=article-tags><a href=/tags/react/>React</a>
<a href=/tags/react18/>React18</a>
<a href=/tags/reat18%E5%9F%BA%E7%A1%80/>Reat18基础</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><div class=disqus-container><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//hugo-theme-stack.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2025 半夜酒</section><section class=powerby>使用 <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> 构建<br>主题 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.25.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>